2025-08-20 14:17:30,550 - __main__ - INFO - Initializing PO Automation System...
2025-08-20 14:17:30,551 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-20 14:17:30,551 - __main__ - INFO - PO Automation System initialized successfully
2025-08-20 14:17:30,551 - __main__ - INFO - Processing PO for supplier SUP001
2025-08-20 14:17:30,552 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-20 14:17:30,573 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-20 14:17:30,577 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-20 14:17:32,685 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-20 14:17:32,692 - workflows.po_workflow - INFO - PO validation completed for PO-20250820141730
2025-08-20 14:17:32,694 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250820141730
2025-08-20 14:17:48,459 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250820141730
2025-08-20 14:17:48,460 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250820141730
2025-08-20 14:17:58,695 - workflows.po_workflow - WARNING - Budget check failed for PO-20250820141730
2025-08-20 14:17:58,697 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250820141730
2025-08-20 14:18:04,447 - workflows.po_workflow - INFO - Notifications sent for PO-20250820141730
2025-08-20 14:18:04,449 - workflows.po_workflow - INFO - PO processing completed for PO-20250820141730 in 33.90s
2025-08-20 14:18:04,449 - __main__ - INFO - PO PO-20250820141730 processed in 33.90s - Decision: REJECTED
2025-08-20 14:18:05,463 - __main__ - INFO - Processing PO for supplier SUP002
2025-08-20 14:18:05,464 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-20 14:18:05,466 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-20 14:18:07,312 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-20 14:18:07,316 - workflows.po_workflow - INFO - PO validation completed for PO-20250820141805
2025-08-20 14:18:07,319 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250820141805
2025-08-20 14:18:23,844 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250820141805
2025-08-20 14:18:23,845 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250820141805
2025-08-20 14:18:34,786 - workflows.po_workflow - WARNING - Budget check failed for PO-20250820141805
2025-08-20 14:18:34,787 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250820141805
2025-08-20 14:18:40,359 - workflows.po_workflow - INFO - Notifications sent for PO-20250820141805
2025-08-20 14:18:40,361 - workflows.po_workflow - INFO - PO processing completed for PO-20250820141805 in 34.90s
2025-08-20 14:18:40,361 - __main__ - INFO - PO PO-20250820141805 processed in 34.90s - Decision: REJECTED
2025-08-20 14:18:41,375 - __main__ - INFO - Processing PO for supplier SUP003
2025-08-20 14:18:41,375 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-20 14:18:41,376 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-20 14:18:43,425 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-20 14:18:43,426 - workflows.po_workflow - INFO - PO validation completed for PO-20250820141841
2025-08-20 14:18:43,427 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250820141841
2025-08-20 14:19:00,116 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250820141841
2025-08-20 14:19:00,118 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250820141841
2025-08-20 14:19:17,443 - workflows.po_workflow - INFO - Budget reserved for PO-20250820141841
2025-08-20 14:19:17,445 - workflows.po_workflow - INFO - Processing approval for PO PO-20250820141841
2025-08-20 14:19:28,756 - workflows.po_workflow - INFO - PO PO-20250820141841 auto-approved
2025-08-20 14:19:28,757 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250820141841
2025-08-20 14:19:34,377 - workflows.po_workflow - INFO - Notifications sent for PO-20250820141841
2025-08-20 14:19:34,378 - workflows.po_workflow - INFO - PO processing completed for PO-20250820141841 in 53.00s
2025-08-20 14:19:34,378 - __main__ - INFO - PO PO-20250820141841 processed in 53.00s - Decision: APPROVED
2025-08-20 14:19:35,395 - __main__ - INFO - Processing PO for supplier SUP999
2025-08-20 14:19:35,395 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP999
2025-08-20 14:19:35,396 - workflows.po_workflow - INFO - Starting PO validation for request: SUP999
2025-08-20 14:19:37,699 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-20 14:19:37,701 - workflows.po_workflow - INFO - PO validation completed for PO-20250820141935
2025-08-20 14:19:37,701 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250820141935
2025-08-20 14:19:54,786 - workflows.po_workflow - WARNING - Supplier validation failed for PO-20250820141935
2025-08-20 14:19:54,788 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250820141935
2025-08-20 14:20:00,868 - workflows.po_workflow - INFO - Notifications sent for PO-20250820141935
2025-08-20 14:20:00,870 - workflows.po_workflow - INFO - PO processing completed for PO-20250820141935 in 25.47s
2025-08-20 14:20:00,870 - __main__ - INFO - PO PO-20250820141935 processed in 25.47s - Decision: REJECTED
2025-08-20 14:20:01,875 - __main__ - INFO - PO Automation System closed
2025-08-20 19:59:49,042 - __main__ - INFO - Initializing PO Automation System...
2025-08-20 19:59:49,042 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-20 19:59:49,043 - __main__ - INFO - PO Automation System initialized successfully
2025-08-20 19:59:49,058 - database.db_operations - ERROR - Database connection error: ('IM002', '[IM002] [Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified (0) (SQLDriverConnect)')
2025-08-20 19:59:49,059 - database.db_operations - ERROR - Error fetching purchase orders: ('IM002', '[IM002] [Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified (0) (SQLDriverConnect)')
2025-08-20 19:59:49,059 - __main__ - ERROR - Error running sample scenarios: ('IM002', '[IM002] [Microsoft][ODBC Driver Manager] Data source name not found and no default driver specified (0) (SQLDriverConnect)')
2025-08-20 19:59:49,060 - database.db_operations - INFO - Database manager closed
2025-08-20 19:59:49,060 - __main__ - INFO - PO Automation System closed
2025-08-20 20:12:16,117 - __main__ - INFO - Initializing PO Automation System...
2025-08-20 20:12:16,118 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-20 20:12:16,119 - __main__ - INFO - PO Automation System initialized successfully
2025-08-20 20:12:18,881 - database.db_operations - INFO - Found 4 purchase orders
2025-08-20 20:12:20,198 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-20 20:12:20,199 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-20 20:12:20,298 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-20 20:12:20,314 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-20 20:12:23,374 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-20 20:12:23,387 - workflows.po_workflow - INFO - PO validation completed for PO-20250820201220
2025-08-20 20:12:23,390 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250820201220
2025-08-20 20:12:43,353 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250820201220
2025-08-20 20:12:43,356 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250820201220
2025-08-20 20:12:57,648 - workflows.po_workflow - WARNING - Budget check failed for PO-20250820201220
2025-08-20 20:12:57,651 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250820201220
2025-08-20 20:13:04,682 - workflows.po_workflow - INFO - Notifications sent for PO-20250820201220
2025-08-20 20:13:04,688 - workflows.po_workflow - INFO - PO processing completed for PO-20250820201220 in 44.49s
2025-08-20 20:13:04,689 - __main__ - INFO - PO PO-20250820201220 processed in 44.49s - Decision: REJECTED
2025-08-20 20:13:05,722 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-20 20:13:05,723 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-20 20:13:05,725 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-20 20:13:08,421 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-20 20:13:08,426 - workflows.po_workflow - INFO - PO validation completed for PO-20250820201305
2025-08-20 20:13:08,428 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250820201305
2025-08-20 20:13:29,373 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250820201305
2025-08-20 20:13:29,375 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250820201305
2025-08-20 20:13:42,584 - workflows.po_workflow - WARNING - Budget check failed for PO-20250820201305
2025-08-20 20:13:42,586 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250820201305
2025-08-20 20:13:49,218 - workflows.po_workflow - INFO - Notifications sent for PO-20250820201305
2025-08-20 20:13:49,220 - workflows.po_workflow - INFO - PO processing completed for PO-20250820201305 in 43.50s
2025-08-20 20:13:49,220 - __main__ - INFO - PO PO-20250820201305 processed in 43.50s - Decision: REJECTED
2025-08-20 20:13:50,232 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-20 20:13:50,233 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-20 20:13:50,235 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-20 20:13:52,077 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-20 20:13:52,079 - workflows.po_workflow - INFO - PO validation completed for PO-20250820201350
2025-08-20 20:13:52,081 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250820201350
2025-08-20 20:14:14,062 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250820201350
2025-08-20 20:14:14,065 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250820201350
2025-08-20 20:14:35,059 - workflows.po_workflow - INFO - Budget reserved for PO-20250820201350
2025-08-20 20:14:35,061 - workflows.po_workflow - INFO - Processing approval for PO PO-20250820201350
2025-08-20 20:14:49,504 - workflows.po_workflow - INFO - PO PO-20250820201350 auto-approved
2025-08-20 20:14:49,507 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250820201350
2025-08-20 20:14:56,300 - workflows.po_workflow - INFO - Notifications sent for PO-20250820201350
2025-08-20 20:14:56,304 - workflows.po_workflow - INFO - PO processing completed for PO-20250820201350 in 66.07s
2025-08-20 20:14:56,305 - __main__ - INFO - PO PO-20250820201350 processed in 66.07s - Decision: APPROVED
2025-08-20 20:14:57,333 - __main__ - INFO - Processing PO 4 for supplier SUP999
2025-08-20 20:14:57,333 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP999
2025-08-20 20:14:57,336 - workflows.po_workflow - INFO - Starting PO validation for request: SUP999
2025-08-20 20:14:59,423 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-20 20:14:59,426 - workflows.po_workflow - INFO - PO validation completed for PO-20250820201457
2025-08-20 20:14:59,431 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250820201457
2025-08-20 20:15:19,682 - workflows.po_workflow - WARNING - Supplier validation failed for PO-20250820201457
2025-08-20 20:15:19,684 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250820201457
2025-08-20 20:15:26,287 - workflows.po_workflow - INFO - Notifications sent for PO-20250820201457
2025-08-20 20:15:26,288 - workflows.po_workflow - INFO - PO processing completed for PO-20250820201457 in 28.95s
2025-08-20 20:15:26,289 - __main__ - INFO - PO PO-20250820201457 processed in 28.95s - Decision: REJECTED
2025-08-20 20:15:27,305 - database.db_operations - INFO - Database manager closed
2025-08-20 20:15:27,305 - __main__ - INFO - PO Automation System closed
2025-08-21 01:00:34,198 - __main__ - INFO - Initializing PO Automation System...
2025-08-21 01:00:34,199 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-21 01:00:34,199 - __main__ - INFO - PO Automation System initialized successfully
2025-08-21 01:00:35,289 - database.db_operations - ERROR - Database connection error: (207, b"Invalid column name 'amount'.DB-Lib error message 20018, severity 16:\nGeneral SQL Server error: Check messages from the SQL Server\n")
2025-08-21 01:00:35,289 - database.db_operations - ERROR - Error fetching purchase orders: (207, b"Invalid column name 'amount'.DB-Lib error message 20018, severity 16:\nGeneral SQL Server error: Check messages from the SQL Server\n")
2025-08-21 01:00:35,290 - __main__ - ERROR - Error running sample scenarios: (207, b"Invalid column name 'amount'.DB-Lib error message 20018, severity 16:\nGeneral SQL Server error: Check messages from the SQL Server\n")
2025-08-21 01:00:35,290 - database.db_operations - INFO - Database manager closed
2025-08-21 01:00:35,290 - __main__ - INFO - PO Automation System closed
2025-08-21 01:01:55,715 - __main__ - INFO - Initializing PO Automation System...
2025-08-21 01:01:55,715 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-21 01:01:55,715 - __main__ - INFO - PO Automation System initialized successfully
2025-08-21 01:01:56,575 - database.db_operations - ERROR - Database connection error: (207, b"Invalid column name 'amount'.DB-Lib error message 20018, severity 16:\nGeneral SQL Server error: Check messages from the SQL Server\n")
2025-08-21 01:01:56,576 - database.db_operations - ERROR - Error fetching purchase orders: (207, b"Invalid column name 'amount'.DB-Lib error message 20018, severity 16:\nGeneral SQL Server error: Check messages from the SQL Server\n")
2025-08-21 01:01:56,576 - __main__ - ERROR - Error running sample scenarios: (207, b"Invalid column name 'amount'.DB-Lib error message 20018, severity 16:\nGeneral SQL Server error: Check messages from the SQL Server\n")
2025-08-21 01:01:56,576 - database.db_operations - INFO - Database manager closed
2025-08-21 01:01:56,577 - __main__ - INFO - PO Automation System closed
2025-08-21 01:06:45,808 - __main__ - INFO - Initializing PO Automation System...
2025-08-21 01:06:45,809 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-21 01:06:45,809 - __main__ - INFO - PO Automation System initialized successfully
2025-08-21 01:06:47,009 - database.db_operations - INFO - Found 4 purchase orders
2025-08-21 01:06:47,342 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-21 01:06:47,343 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-21 01:06:47,374 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-21 01:06:47,388 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-21 01:06:47,388 - workflows.po_workflow - WARNING - PO validation failed: Missing required field: amount
2025-08-21 01:06:47,390 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250821010647
2025-08-21 01:06:49,327 - workflows.po_workflow - ERROR - Error sending notifications: 'amount'
2025-08-21 01:06:49,328 - workflows.po_workflow - ERROR - Workflow execution failed: 'send_notifications'
2025-08-21 01:06:49,328 - workflows.po_workflow - ERROR - Full traceback:
Traceback (most recent call last):
  File "C:\Demo Projects\PoAutomationAgent\workflows\po_workflow.py", line 580, in process_po
    result = await self.workflow.ainvoke(initial_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 3112, in ainvoke
    async for chunk in self.astream(
    ...<29 lines>...
            chunks.append(chunk)
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 2939, in astream
    async for _ in runner.atick(
    ...<13 lines>...
            yield o
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_runner.py", line 295, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 712, in ainvoke
    input = await step.ainvoke(input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 192, in _aroute
    return self._finish(writer, input, result, config)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 205, in _finish
    r if isinstance(r, Send) else self.ends[r] for r in result
                                  ~~~~~~~~~^^^
KeyError: 'send_notifications'
During task with name 'send_notifications' and id 'd1fb1cdf-11a1-70af-f638-61d732ca1997'
2025-08-21 01:06:49,378 - __main__ - INFO - PO  processed in 2.04s - Decision: ERROR
2025-08-21 01:06:49,379 - __main__ - WARNING - PO  error: Workflow execution failed: 'send_notifications'
2025-08-21 01:06:50,392 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-21 01:06:50,392 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-21 01:06:50,393 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-21 01:06:50,394 - workflows.po_workflow - WARNING - PO validation failed: Missing required field: amount
2025-08-21 01:06:50,396 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250821010650
2025-08-21 01:06:52,372 - workflows.po_workflow - ERROR - Error sending notifications: 'amount'
2025-08-21 01:06:52,373 - workflows.po_workflow - ERROR - Workflow execution failed: 'send_notifications'
2025-08-21 01:06:52,373 - workflows.po_workflow - ERROR - Full traceback:
Traceback (most recent call last):
  File "C:\Demo Projects\PoAutomationAgent\workflows\po_workflow.py", line 580, in process_po
    result = await self.workflow.ainvoke(initial_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 3112, in ainvoke
    async for chunk in self.astream(
    ...<29 lines>...
            chunks.append(chunk)
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 2939, in astream
    async for _ in runner.atick(
    ...<13 lines>...
            yield o
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_runner.py", line 295, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 712, in ainvoke
    input = await step.ainvoke(input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 192, in _aroute
    return self._finish(writer, input, result, config)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 205, in _finish
    r if isinstance(r, Send) else self.ends[r] for r in result
                                  ~~~~~~~~~^^^
KeyError: 'send_notifications'
During task with name 'send_notifications' and id '601b1964-c436-27bd-d716-0249ee479be5'
2025-08-21 01:06:52,376 - __main__ - INFO - PO  processed in 1.98s - Decision: ERROR
2025-08-21 01:06:52,376 - __main__ - WARNING - PO  error: Workflow execution failed: 'send_notifications'
2025-08-21 01:06:53,378 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-21 01:06:53,379 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-21 01:06:53,380 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-21 01:06:53,380 - workflows.po_workflow - WARNING - PO validation failed: Missing required field: amount
2025-08-21 01:06:53,381 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250821010653
2025-08-21 01:06:55,353 - workflows.po_workflow - ERROR - Error sending notifications: 'amount'
2025-08-21 01:06:55,354 - workflows.po_workflow - ERROR - Workflow execution failed: 'send_notifications'
2025-08-21 01:06:55,354 - workflows.po_workflow - ERROR - Full traceback:
Traceback (most recent call last):
  File "C:\Demo Projects\PoAutomationAgent\workflows\po_workflow.py", line 580, in process_po
    result = await self.workflow.ainvoke(initial_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 3112, in ainvoke
    async for chunk in self.astream(
    ...<29 lines>...
            chunks.append(chunk)
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 2939, in astream
    async for _ in runner.atick(
    ...<13 lines>...
            yield o
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_runner.py", line 295, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 712, in ainvoke
    input = await step.ainvoke(input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 192, in _aroute
    return self._finish(writer, input, result, config)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 205, in _finish
    r if isinstance(r, Send) else self.ends[r] for r in result
                                  ~~~~~~~~~^^^
KeyError: 'send_notifications'
During task with name 'send_notifications' and id '24155c91-be9f-bf7a-1235-1e7410f6f86c'
2025-08-21 01:06:55,356 - __main__ - INFO - PO  processed in 1.98s - Decision: ERROR
2025-08-21 01:06:55,356 - __main__ - WARNING - PO  error: Workflow execution failed: 'send_notifications'
2025-08-21 01:06:56,360 - __main__ - INFO - Processing PO 4 for supplier SUP999
2025-08-21 01:06:56,361 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP999
2025-08-21 01:06:56,364 - workflows.po_workflow - INFO - Starting PO validation for request: SUP999
2025-08-21 01:06:56,365 - workflows.po_workflow - WARNING - PO validation failed: Missing required field: amount
2025-08-21 01:06:56,367 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250821010656
2025-08-21 01:06:58,343 - workflows.po_workflow - ERROR - Error sending notifications: 'amount'
2025-08-21 01:06:58,344 - workflows.po_workflow - ERROR - Workflow execution failed: 'send_notifications'
2025-08-21 01:06:58,344 - workflows.po_workflow - ERROR - Full traceback:
Traceback (most recent call last):
  File "C:\Demo Projects\PoAutomationAgent\workflows\po_workflow.py", line 580, in process_po
    result = await self.workflow.ainvoke(initial_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 3112, in ainvoke
    async for chunk in self.astream(
    ...<29 lines>...
            chunks.append(chunk)
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 2939, in astream
    async for _ in runner.atick(
    ...<13 lines>...
            yield o
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_runner.py", line 295, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 712, in ainvoke
    input = await step.ainvoke(input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 192, in _aroute
    return self._finish(writer, input, result, config)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 205, in _finish
    r if isinstance(r, Send) else self.ends[r] for r in result
                                  ~~~~~~~~~^^^
KeyError: 'send_notifications'
During task with name 'send_notifications' and id '92fc9e2a-422a-e58f-00cc-b34f85486b46'
2025-08-21 01:06:58,347 - __main__ - INFO - PO  processed in 1.99s - Decision: ERROR
2025-08-21 01:06:58,347 - __main__ - WARNING - PO  error: Workflow execution failed: 'send_notifications'
2025-08-21 01:06:59,363 - database.db_operations - INFO - Database manager closed
2025-08-21 01:06:59,364 - __main__ - INFO - PO Automation System closed
2025-08-21 01:10:26,513 - __main__ - INFO - Initializing PO Automation System...
2025-08-21 01:10:26,514 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-21 01:10:26,514 - __main__ - INFO - PO Automation System initialized successfully
2025-08-21 01:10:27,410 - database.db_operations - INFO - Found 4 purchase orders
2025-08-21 01:10:27,640 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-21 01:10:27,641 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-21 01:10:27,665 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-21 01:10:27,672 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-21 01:10:30,186 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-21 01:10:30,192 - workflows.po_workflow - INFO - PO validation completed for PO-20250821011027
2025-08-21 01:10:30,194 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250821011027
2025-08-21 01:10:47,032 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250821011027
2025-08-21 01:10:47,034 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250821011027
2025-08-21 01:10:57,990 - workflows.po_workflow - WARNING - Budget check failed for PO-20250821011027
2025-08-21 01:10:57,991 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250821011027
2025-08-21 01:11:03,592 - workflows.po_workflow - INFO - Notifications sent for PO-20250821011027
2025-08-21 01:11:03,594 - workflows.po_workflow - INFO - PO processing completed for PO-20250821011027 in 35.95s
2025-08-21 01:11:03,594 - __main__ - INFO - PO PO-20250821011027 processed in 35.95s - Decision: REJECTED
2025-08-21 01:11:04,598 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-21 01:11:04,598 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-21 01:11:04,599 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-21 01:11:06,829 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-21 01:11:06,834 - workflows.po_workflow - INFO - PO validation completed for PO-20250821011104
2025-08-21 01:11:06,835 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250821011104
2025-08-21 01:11:23,228 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250821011104
2025-08-21 01:11:23,229 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250821011104
2025-08-21 01:11:34,737 - workflows.po_workflow - WARNING - Budget check failed for PO-20250821011104
2025-08-21 01:11:34,738 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250821011104
2025-08-21 01:11:40,357 - workflows.po_workflow - INFO - Notifications sent for PO-20250821011104
2025-08-21 01:11:40,358 - workflows.po_workflow - INFO - PO processing completed for PO-20250821011104 in 35.76s
2025-08-21 01:11:40,358 - __main__ - INFO - PO PO-20250821011104 processed in 35.76s - Decision: REJECTED
2025-08-21 01:11:41,366 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-21 01:11:41,367 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-21 01:11:41,370 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-21 01:11:43,459 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-21 01:11:43,460 - workflows.po_workflow - INFO - PO validation completed for PO-20250821011141
2025-08-21 01:11:43,461 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250821011141
2025-08-21 01:11:59,988 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250821011141
2025-08-21 01:11:59,989 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250821011141
2025-08-21 01:12:17,182 - workflows.po_workflow - INFO - Budget reserved for PO-20250821011141
2025-08-21 01:12:17,184 - workflows.po_workflow - INFO - Processing approval for PO PO-20250821011141
2025-08-21 01:12:28,511 - workflows.po_workflow - INFO - PO PO-20250821011141 auto-approved
2025-08-21 01:12:28,512 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250821011141
2025-08-21 01:12:34,561 - workflows.po_workflow - INFO - Notifications sent for PO-20250821011141
2025-08-21 01:12:34,563 - workflows.po_workflow - INFO - PO processing completed for PO-20250821011141 in 53.20s
2025-08-21 01:12:34,563 - __main__ - INFO - PO PO-20250821011141 processed in 53.20s - Decision: APPROVED
2025-08-21 01:12:35,579 - __main__ - INFO - Processing PO 4 for supplier SUP999
2025-08-21 01:12:35,579 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP999
2025-08-21 01:12:35,580 - workflows.po_workflow - INFO - Starting PO validation for request: SUP999
2025-08-21 01:12:37,700 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-21 01:12:37,701 - workflows.po_workflow - INFO - PO validation completed for PO-20250821011235
2025-08-21 01:12:37,702 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250821011235
2025-08-21 01:12:55,076 - workflows.po_workflow - WARNING - Supplier validation failed for PO-20250821011235
2025-08-21 01:12:55,077 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250821011235
2025-08-21 01:13:01,267 - workflows.po_workflow - INFO - Notifications sent for PO-20250821011235
2025-08-21 01:13:01,269 - workflows.po_workflow - INFO - PO processing completed for PO-20250821011235 in 25.69s
2025-08-21 01:13:01,269 - __main__ - INFO - PO PO-20250821011235 processed in 25.69s - Decision: REJECTED
2025-08-21 01:13:02,282 - database.db_operations - INFO - Database manager closed
2025-08-21 01:13:02,282 - __main__ - INFO - PO Automation System closed
2025-08-21 12:35:41,771 - __main__ - INFO - Initializing PO Automation System...
2025-08-21 12:35:41,772 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-21 12:35:41,772 - __main__ - INFO - PO Automation System initialized successfully
2025-08-21 12:35:42,431 - database.db_operations - INFO - Found 4 purchase orders
2025-08-21 12:35:42,581 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-21 12:35:42,582 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-21 12:35:42,618 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-21 12:35:42,700 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-21 12:35:45,559 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-21 12:35:45,567 - workflows.po_workflow - INFO - PO validation completed for PO-20250821123542
2025-08-21 12:35:45,568 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250821123542
2025-08-21 12:36:05,067 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250821123542
2025-08-21 12:36:05,070 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250821123542
2025-08-21 12:36:17,727 - workflows.po_workflow - WARNING - Budget check failed for PO-20250821123542
2025-08-21 12:36:17,729 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250821123542
2025-08-21 12:36:23,625 - workflows.po_workflow - INFO - Notifications sent for PO-20250821123542
2025-08-21 12:36:23,628 - workflows.po_workflow - INFO - PO processing completed for PO-20250821123542 in 41.05s
2025-08-21 12:36:23,628 - __main__ - INFO - PO PO-20250821123542 processed in 41.05s - Decision: REJECTED
2025-08-21 12:36:24,637 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-21 12:36:24,638 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-21 12:36:24,641 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-21 12:36:27,254 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-21 12:36:27,257 - workflows.po_workflow - INFO - PO validation completed for PO-20250821123624
2025-08-21 12:36:27,259 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250821123624
2025-08-21 12:36:46,713 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250821123624
2025-08-21 12:36:46,715 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250821123624
2025-08-21 12:36:59,582 - workflows.po_workflow - WARNING - Budget check failed for PO-20250821123624
2025-08-21 12:36:59,584 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250821123624
2025-08-21 12:37:06,256 - workflows.po_workflow - INFO - Notifications sent for PO-20250821123624
2025-08-21 12:37:06,258 - workflows.po_workflow - INFO - PO processing completed for PO-20250821123624 in 41.62s
2025-08-21 12:37:06,258 - __main__ - INFO - PO PO-20250821123624 processed in 41.62s - Decision: REJECTED
2025-08-21 12:37:07,265 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-21 12:37:07,266 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-21 12:37:07,267 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-21 12:37:09,522 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-21 12:37:09,525 - workflows.po_workflow - INFO - PO validation completed for PO-20250821123707
2025-08-21 12:37:09,527 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250821123707
2025-08-21 12:37:29,551 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250821123707
2025-08-21 12:37:29,553 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250821123707
2025-08-21 12:37:49,314 - workflows.po_workflow - INFO - Budget reserved for PO-20250821123707
2025-08-21 12:37:49,316 - workflows.po_workflow - INFO - Processing approval for PO PO-20250821123707
2025-08-21 12:38:02,243 - workflows.po_workflow - INFO - PO PO-20250821123707 auto-approved
2025-08-21 12:38:02,246 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250821123707
2025-08-21 12:38:09,139 - workflows.po_workflow - INFO - Notifications sent for PO-20250821123707
2025-08-21 12:38:09,140 - workflows.po_workflow - INFO - PO processing completed for PO-20250821123707 in 61.87s
2025-08-21 12:38:09,141 - __main__ - INFO - PO PO-20250821123707 processed in 61.87s - Decision: APPROVED
2025-08-21 12:38:10,144 - __main__ - INFO - Processing PO 4 for supplier SUP999
2025-08-21 12:38:10,144 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP999
2025-08-21 12:38:10,145 - workflows.po_workflow - INFO - Starting PO validation for request: SUP999
2025-08-21 12:38:12,500 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-21 12:38:12,502 - workflows.po_workflow - INFO - PO validation completed for PO-20250821123810
2025-08-21 12:38:12,503 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250821123810
2025-08-21 12:38:31,008 - workflows.po_workflow - WARNING - Supplier validation failed for PO-20250821123810
2025-08-21 12:38:31,010 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250821123810
2025-08-21 12:38:36,780 - workflows.po_workflow - INFO - Notifications sent for PO-20250821123810
2025-08-21 12:38:36,781 - workflows.po_workflow - INFO - PO processing completed for PO-20250821123810 in 26.64s
2025-08-21 12:38:36,782 - __main__ - INFO - PO PO-20250821123810 processed in 26.64s - Decision: REJECTED
2025-08-21 12:38:37,791 - database.db_operations - INFO - Database manager closed
2025-08-21 12:38:37,792 - __main__ - INFO - PO Automation System closed
2025-08-21 15:10:12,725 - __main__ - INFO - Initializing PO Automation System...
2025-08-21 15:10:12,725 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-21 15:10:12,726 - __main__ - INFO - PO Automation System initialized successfully
2025-08-21 15:10:13,363 - database.db_operations - INFO - Found 4 purchase orders
2025-08-21 15:10:13,504 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-21 15:10:13,505 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-21 15:10:13,524 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-21 15:10:13,531 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-21 15:10:15,962 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-21 15:10:15,968 - workflows.po_workflow - INFO - PO validation completed for PO-20250821151013
2025-08-21 15:10:15,970 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250821151013
2025-08-21 15:10:33,912 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250821151013
2025-08-21 15:10:33,914 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250821151013
2025-08-21 15:10:45,815 - workflows.po_workflow - WARNING - Budget check failed for PO-20250821151013
2025-08-21 15:10:45,817 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250821151013
2025-08-21 15:10:52,041 - workflows.po_workflow - INFO - Notifications sent for PO-20250821151013
2025-08-21 15:10:52,042 - workflows.po_workflow - INFO - PO processing completed for PO-20250821151013 in 38.54s
2025-08-21 15:10:52,042 - __main__ - INFO - PO PO-20250821151013 processed in 38.54s - Decision: REJECTED
2025-08-21 15:10:53,057 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-21 15:10:53,058 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-21 15:10:53,059 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-21 15:10:55,485 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-21 15:10:55,487 - workflows.po_workflow - INFO - PO validation completed for PO-20250821151053
2025-08-21 15:10:55,488 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250821151053
2025-08-21 15:11:14,512 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250821151053
2025-08-21 15:11:14,514 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250821151053
2025-08-21 15:11:26,571 - workflows.po_workflow - WARNING - Budget check failed for PO-20250821151053
2025-08-21 15:11:26,573 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250821151053
2025-08-21 15:11:32,979 - workflows.po_workflow - INFO - Notifications sent for PO-20250821151053
2025-08-21 15:11:32,981 - workflows.po_workflow - INFO - PO processing completed for PO-20250821151053 in 39.92s
2025-08-21 15:11:32,982 - __main__ - INFO - PO PO-20250821151053 processed in 39.92s - Decision: REJECTED
2025-08-21 15:11:33,992 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-21 15:11:33,992 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-21 15:11:33,995 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-21 15:11:35,952 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-21 15:11:35,958 - workflows.po_workflow - INFO - PO validation completed for PO-20250821151133
2025-08-21 15:11:35,959 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250821151133
2025-08-21 15:11:55,076 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250821151133
2025-08-21 15:11:55,077 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250821151133
2025-08-21 15:12:13,570 - workflows.po_workflow - INFO - Budget reserved for PO-20250821151133
2025-08-21 15:12:13,571 - workflows.po_workflow - INFO - Processing approval for PO PO-20250821151133
2025-08-21 15:12:25,638 - workflows.po_workflow - INFO - PO PO-20250821151133 auto-approved
2025-08-21 15:12:25,639 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250821151133
2025-08-21 15:12:32,158 - workflows.po_workflow - INFO - Notifications sent for PO-20250821151133
2025-08-21 15:12:32,160 - workflows.po_workflow - INFO - PO processing completed for PO-20250821151133 in 58.17s
2025-08-21 15:12:32,161 - __main__ - INFO - PO PO-20250821151133 processed in 58.17s - Decision: APPROVED
2025-08-21 15:12:33,175 - __main__ - INFO - Processing PO 4 for supplier SUP999
2025-08-21 15:12:33,176 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP999
2025-08-21 15:12:33,177 - workflows.po_workflow - INFO - Starting PO validation for request: SUP999
2025-08-21 15:12:35,436 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-21 15:12:35,438 - workflows.po_workflow - INFO - PO validation completed for PO-20250821151233
2025-08-21 15:12:35,441 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250821151233
2025-08-21 15:12:54,026 - workflows.po_workflow - WARNING - Supplier validation failed for PO-20250821151233
2025-08-21 15:12:54,028 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250821151233
2025-08-21 15:13:00,571 - workflows.po_workflow - INFO - Notifications sent for PO-20250821151233
2025-08-21 15:13:00,573 - workflows.po_workflow - INFO - PO processing completed for PO-20250821151233 in 27.40s
2025-08-21 15:13:00,573 - __main__ - INFO - PO PO-20250821151233 processed in 27.40s - Decision: REJECTED
2025-08-21 15:13:01,588 - database.db_operations - INFO - Database manager closed
2025-08-21 15:13:01,589 - __main__ - INFO - PO Automation System closed
2025-08-21 20:56:38,955 - __main__ - INFO - Initializing PO Automation System...
2025-08-21 20:56:38,956 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-21 20:56:38,957 - __main__ - INFO - PO Automation System initialized successfully
2025-08-21 20:56:40,159 - database.db_operations - INFO - Found 4 purchase orders
2025-08-21 20:56:40,421 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-21 20:56:40,422 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-21 20:56:40,486 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-21 20:56:40,504 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-21 20:56:43,540 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-21 20:56:43,565 - workflows.po_workflow - INFO - PO validation completed for PO-20250821205640
2025-08-21 20:56:43,569 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250821205640
2025-08-21 20:57:05,593 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250821205640
2025-08-21 20:57:05,596 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250821205640
2025-08-21 20:57:20,741 - workflows.po_workflow - WARNING - Budget check failed for PO-20250821205640
2025-08-21 20:57:20,745 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250821205640
2025-08-21 20:57:28,327 - workflows.po_workflow - INFO - Notifications sent for PO-20250821205640
2025-08-21 20:57:28,329 - workflows.po_workflow - INFO - PO processing completed for PO-20250821205640 in 47.91s
2025-08-21 20:57:28,329 - __main__ - INFO - PO PO-20250821205640 processed in 47.91s - Decision: REJECTED
2025-08-21 20:57:29,344 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-21 20:57:29,345 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-21 20:57:29,347 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-21 20:57:31,491 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-21 20:57:31,493 - workflows.po_workflow - INFO - PO validation completed for PO-20250821205729
2025-08-21 20:57:31,494 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250821205729
2025-08-21 20:57:53,980 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250821205729
2025-08-21 20:57:53,982 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250821205729
2025-08-21 20:58:09,738 - workflows.po_workflow - WARNING - Budget check failed for PO-20250821205729
2025-08-21 20:58:09,740 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250821205729
2025-08-21 20:58:17,105 - workflows.po_workflow - INFO - Notifications sent for PO-20250821205729
2025-08-21 20:58:17,109 - workflows.po_workflow - INFO - PO processing completed for PO-20250821205729 in 47.76s
2025-08-21 20:58:17,110 - __main__ - INFO - PO PO-20250821205729 processed in 47.76s - Decision: REJECTED
2025-08-21 20:58:18,128 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-21 20:58:18,128 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-21 20:58:18,131 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-21 20:58:20,668 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-21 20:58:20,672 - workflows.po_workflow - INFO - PO validation completed for PO-20250821205818
2025-08-21 20:58:20,675 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250821205818
2025-08-21 20:58:45,601 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250821205818
2025-08-21 20:58:45,604 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250821205818
2025-08-21 20:59:15,052 - workflows.po_workflow - INFO - Budget reserved for PO-20250821205818
2025-08-21 20:59:15,056 - workflows.po_workflow - INFO - Processing approval for PO PO-20250821205818
2025-08-21 20:59:31,944 - workflows.po_workflow - INFO - PO PO-20250821205818 auto-approved
2025-08-21 20:59:31,947 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250821205818
2025-08-21 20:59:40,988 - workflows.po_workflow - INFO - Notifications sent for PO-20250821205818
2025-08-21 20:59:40,990 - workflows.po_workflow - INFO - PO processing completed for PO-20250821205818 in 82.86s
2025-08-21 20:59:40,991 - __main__ - INFO - PO PO-20250821205818 processed in 82.86s - Decision: APPROVED
2025-08-21 20:59:41,997 - __main__ - INFO - Processing PO 4 for supplier SUP999
2025-08-21 20:59:41,997 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP999
2025-08-21 20:59:41,999 - workflows.po_workflow - INFO - Starting PO validation for request: SUP999
2025-08-21 20:59:44,244 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-21 20:59:44,247 - workflows.po_workflow - INFO - PO validation completed for PO-20250821205942
2025-08-21 20:59:44,250 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250821205942
2025-08-21 21:00:12,694 - workflows.po_workflow - WARNING - Supplier validation failed for PO-20250821205942
2025-08-21 21:00:12,697 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250821205942
2025-08-21 21:00:23,533 - workflows.po_workflow - INFO - Notifications sent for PO-20250821205942
2025-08-21 21:00:23,537 - workflows.po_workflow - INFO - PO processing completed for PO-20250821205942 in 41.54s
2025-08-21 21:00:23,537 - __main__ - INFO - PO PO-20250821205942 processed in 41.54s - Decision: REJECTED
2025-08-21 21:00:24,544 - database.db_operations - INFO - Database manager closed
2025-08-21 21:00:24,546 - __main__ - INFO - PO Automation System closed
2025-08-21 21:01:16,808 - __main__ - INFO - Initializing PO Automation System...
2025-08-21 21:01:16,809 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-21 21:01:16,809 - __main__ - INFO - PO Automation System initialized successfully
2025-08-21 21:01:17,778 - database.db_operations - INFO - Found 4 purchase orders
2025-08-21 21:01:18,044 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-21 21:01:18,044 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-21 21:01:18,078 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-21 21:01:18,084 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-21 21:01:20,551 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-21 21:01:20,558 - workflows.po_workflow - INFO - PO validation completed for PO-20250821210118
2025-08-21 21:01:20,560 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250821210118
2025-08-21 21:01:39,649 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250821210118
2025-08-21 21:01:39,651 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250821210118
2025-08-21 21:01:53,184 - workflows.po_workflow - WARNING - Budget check failed for PO-20250821210118
2025-08-21 21:01:53,186 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250821210118
2025-08-21 21:02:00,872 - workflows.po_workflow - INFO - Notifications sent for PO-20250821210118
2025-08-21 21:02:00,874 - workflows.po_workflow - INFO - PO processing completed for PO-20250821210118 in 42.83s
2025-08-21 21:02:00,874 - __main__ - INFO - PO PO-20250821210118 processed in 42.83s - Decision: REJECTED
2025-08-21 21:02:01,889 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-21 21:02:01,889 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-21 21:02:01,891 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-21 21:02:04,045 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-21 21:02:04,047 - workflows.po_workflow - INFO - PO validation completed for PO-20250821210201
2025-08-21 21:02:04,049 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250821210201
2025-08-21 21:02:24,556 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250821210201
2025-08-21 21:02:24,558 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250821210201
2025-08-21 21:02:38,348 - workflows.po_workflow - WARNING - Budget check failed for PO-20250821210201
2025-08-21 21:02:38,350 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250821210201
2025-08-21 21:02:44,810 - workflows.po_workflow - INFO - Notifications sent for PO-20250821210201
2025-08-21 21:02:44,812 - workflows.po_workflow - INFO - PO processing completed for PO-20250821210201 in 42.92s
2025-08-21 21:02:44,812 - __main__ - INFO - PO PO-20250821210201 processed in 42.92s - Decision: REJECTED
2025-08-21 21:02:45,818 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-21 21:02:45,818 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-21 21:02:45,819 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-21 21:02:48,174 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-21 21:02:48,176 - workflows.po_workflow - INFO - PO validation completed for PO-20250821210245
2025-08-21 21:02:48,177 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250821210245
2025-08-21 21:03:06,799 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250821210245
2025-08-21 21:03:06,801 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250821210245
2025-08-21 21:03:25,672 - workflows.po_workflow - INFO - Budget reserved for PO-20250821210245
2025-08-21 21:03:25,673 - workflows.po_workflow - INFO - Processing approval for PO PO-20250821210245
2025-08-21 21:03:38,416 - workflows.po_workflow - INFO - PO PO-20250821210245 auto-approved
2025-08-21 21:03:38,418 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250821210245
2025-08-21 21:03:45,009 - workflows.po_workflow - INFO - Notifications sent for PO-20250821210245
2025-08-21 21:03:45,010 - workflows.po_workflow - INFO - PO processing completed for PO-20250821210245 in 59.19s
2025-08-21 21:03:45,011 - __main__ - INFO - PO PO-20250821210245 processed in 59.19s - Decision: APPROVED
2025-08-21 21:03:46,023 - __main__ - INFO - Processing PO 4 for supplier SUP999
2025-08-21 21:03:46,023 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP999
2025-08-21 21:03:46,025 - workflows.po_workflow - INFO - Starting PO validation for request: SUP999
2025-08-21 21:03:48,536 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-21 21:03:48,540 - workflows.po_workflow - INFO - PO validation completed for PO-20250821210346
2025-08-21 21:03:48,543 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250821210346
2025-08-21 21:04:07,565 - workflows.po_workflow - WARNING - Supplier validation failed for PO-20250821210346
2025-08-21 21:04:07,566 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250821210346
2025-08-21 21:04:14,541 - workflows.po_workflow - INFO - Notifications sent for PO-20250821210346
2025-08-21 21:04:14,543 - workflows.po_workflow - INFO - PO processing completed for PO-20250821210346 in 28.52s
2025-08-21 21:04:14,543 - __main__ - INFO - PO PO-20250821210346 processed in 28.52s - Decision: REJECTED
2025-08-21 21:04:15,546 - database.db_operations - INFO - Database manager closed
2025-08-21 21:04:15,546 - __main__ - INFO - PO Automation System closed
2025-08-22 11:21:42,723 - __main__ - INFO - Initializing PO Automation System...
2025-08-22 11:21:42,723 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-22 11:21:42,723 - __main__ - INFO - PO Automation System initialized successfully
2025-08-22 11:21:43,682 - database.db_operations - INFO - Found 4 purchase orders
2025-08-22 11:21:43,928 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-22 11:21:43,929 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-22 11:21:43,930 - workflows.po_workflow - INFO - Calculation Payment node registered
2025-08-22 11:21:43,975 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-22 11:21:43,991 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-22 11:21:46,361 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 11:21:46,375 - workflows.po_workflow - INFO - PO validation completed for PO-20250822112143
2025-08-22 11:21:46,377 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822112143
2025-08-22 11:22:08,692 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822112143
2025-08-22 11:22:08,694 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822112143
2025-08-22 11:22:23,512 - workflows.po_workflow - WARNING - Budget check failed for PO-20250822112143
2025-08-22 11:22:23,514 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822112143
2025-08-22 11:22:45,149 - workflows.po_workflow - INFO - Approval requests sent for PO-20250822112143
2025-08-22 11:22:45,152 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822112143
2025-08-22 11:22:52,212 - workflows.po_workflow - ERROR - Error during payment calculation: invalid literal for int() with base 10: 'PO-20250822112143'
2025-08-22 11:22:52,215 - workflows.po_workflow - ERROR - Workflow execution failed: 'calculate_payment'
2025-08-22 11:22:52,215 - workflows.po_workflow - ERROR - Full traceback:
Traceback (most recent call last):
  File "C:\Demo Projects\PoAutomationAgent\workflows\po_workflow.py", line 1284, in process_po
    result = await self.workflow.ainvoke(initial_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 3112, in ainvoke
    async for chunk in self.astream(
    ...<29 lines>...
            chunks.append(chunk)
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 2939, in astream
    async for _ in runner.atick(
    ...<13 lines>...
            yield o
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_runner.py", line 295, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 712, in ainvoke
    input = await step.ainvoke(input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 192, in _aroute
    return self._finish(writer, input, result, config)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 205, in _finish
    r if isinstance(r, Send) else self.ends[r] for r in result
                                  ~~~~~~~~~^^^
KeyError: 'calculate_payment'
During task with name 'calculate_payment' and id '5003004a-61b1-0822-699d-6c54a0142cb7'
2025-08-22 11:22:52,254 - __main__ - INFO - PO  processed in 68.33s - Decision: ERROR
2025-08-22 11:22:52,254 - __main__ - WARNING - PO  error: Workflow execution failed: 'calculate_payment'
2025-08-22 11:22:53,270 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-22 11:22:53,270 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-22 11:22:53,272 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-22 11:23:08,809 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 11:23:08,811 - workflows.po_workflow - INFO - PO validation completed for PO-20250822112253
2025-08-22 11:23:08,813 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822112253
2025-08-22 11:23:30,875 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822112253
2025-08-22 11:23:30,878 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822112253
2025-08-22 11:23:44,901 - workflows.po_workflow - WARNING - Budget check failed for PO-20250822112253
2025-08-22 11:23:44,903 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822112253
2025-08-22 11:24:06,354 - workflows.po_workflow - INFO - Approval requests sent for PO-20250822112253
2025-08-22 11:24:06,356 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822112253
2025-08-22 11:24:13,297 - workflows.po_workflow - ERROR - Error during payment calculation: invalid literal for int() with base 10: 'PO-20250822112253'
2025-08-22 11:24:13,299 - workflows.po_workflow - ERROR - Workflow execution failed: 'calculate_payment'
2025-08-22 11:24:13,300 - workflows.po_workflow - ERROR - Full traceback:
Traceback (most recent call last):
  File "C:\Demo Projects\PoAutomationAgent\workflows\po_workflow.py", line 1284, in process_po
    result = await self.workflow.ainvoke(initial_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 3112, in ainvoke
    async for chunk in self.astream(
    ...<29 lines>...
            chunks.append(chunk)
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 2939, in astream
    async for _ in runner.atick(
    ...<13 lines>...
            yield o
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_runner.py", line 295, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 712, in ainvoke
    input = await step.ainvoke(input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 192, in _aroute
    return self._finish(writer, input, result, config)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 205, in _finish
    r if isinstance(r, Send) else self.ends[r] for r in result
                                  ~~~~~~~~~^^^
KeyError: 'calculate_payment'
During task with name 'calculate_payment' and id '56875afc-530b-a6ff-6f4d-3ff0144692d7'
2025-08-22 11:24:13,306 - __main__ - INFO - PO  processed in 80.04s - Decision: ERROR
2025-08-22 11:24:13,306 - __main__ - WARNING - PO  error: Workflow execution failed: 'calculate_payment'
2025-08-22 11:24:14,314 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-22 11:24:14,315 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-22 11:24:14,316 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-22 11:24:26,379 - openai._base_client - INFO - Retrying request to /chat/completions in 0.472524 seconds
2025-08-22 11:24:26,862 - openai._base_client - INFO - Retrying request to /chat/completions in 0.999788 seconds
2025-08-22 11:24:32,514 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 11:24:32,518 - workflows.po_workflow - INFO - PO validation completed for PO-20250822112414
2025-08-22 11:24:32,520 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822112414
2025-08-22 11:24:55,089 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822112414
2025-08-22 11:24:55,091 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822112414
2025-08-22 11:25:25,979 - workflows.po_workflow - INFO - Budget reserved for PO-20250822112414
2025-08-22 11:25:25,981 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822112414
2025-08-22 11:25:47,397 - workflows.po_workflow - INFO - PO PO-20250822112414 auto-approved
2025-08-22 11:25:47,399 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822112414
2025-08-22 11:25:57,319 - workflows.po_workflow - ERROR - Error during payment calculation: invalid literal for int() with base 10: 'PO-20250822112414'
2025-08-22 11:25:57,321 - workflows.po_workflow - ERROR - Workflow execution failed: 'calculate_payment'
2025-08-22 11:25:57,321 - workflows.po_workflow - ERROR - Full traceback:
Traceback (most recent call last):
  File "C:\Demo Projects\PoAutomationAgent\workflows\po_workflow.py", line 1284, in process_po
    result = await self.workflow.ainvoke(initial_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 3112, in ainvoke
    async for chunk in self.astream(
    ...<29 lines>...
            chunks.append(chunk)
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 2939, in astream
    async for _ in runner.atick(
    ...<13 lines>...
            yield o
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_runner.py", line 295, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 712, in ainvoke
    input = await step.ainvoke(input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 192, in _aroute
    return self._finish(writer, input, result, config)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 205, in _finish
    r if isinstance(r, Send) else self.ends[r] for r in result
                                  ~~~~~~~~~^^^
KeyError: 'calculate_payment'
During task with name 'calculate_payment' and id '72943f34-cc3c-92a1-79e2-5c635f4f4a4d'
2025-08-22 11:25:57,326 - __main__ - INFO - PO  processed in 103.01s - Decision: ERROR
2025-08-22 11:25:57,327 - __main__ - WARNING - PO  error: Workflow execution failed: 'calculate_payment'
2025-08-22 11:25:58,334 - __main__ - INFO - Processing PO 4 for supplier SUP999
2025-08-22 11:25:58,335 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP999
2025-08-22 11:25:58,336 - workflows.po_workflow - INFO - Starting PO validation for request: SUP999
2025-08-22 11:37:06,503 - database.db_operations - INFO - Database manager closed
2025-08-22 11:37:06,504 - __main__ - INFO - PO Automation System closed
2025-08-22 11:37:16,538 - __main__ - INFO - Initializing PO Automation System...
2025-08-22 11:37:16,538 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-22 11:37:16,539 - __main__ - INFO - PO Automation System initialized successfully
2025-08-22 11:37:17,728 - database.db_operations - INFO - Found 4 purchase orders
2025-08-22 11:37:17,968 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-22 11:37:17,968 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-22 11:37:17,998 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-22 11:37:18,007 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-22 11:37:20,936 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 11:37:20,946 - workflows.po_workflow - INFO - PO validation completed for PO-20250822113718
2025-08-22 11:37:20,949 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822113718
2025-08-22 11:37:42,949 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822113718
2025-08-22 11:37:42,951 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822113718
2025-08-22 11:37:57,876 - workflows.po_workflow - WARNING - Budget check failed for PO-20250822113718
2025-08-22 11:37:57,878 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822113718
2025-08-22 11:38:24,723 - workflows.po_workflow - INFO - Approval requests sent for PO-20250822113718
2025-08-22 11:38:24,725 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822113718
2025-08-22 11:38:47,223 - workflows.po_workflow - ERROR - Workflow execution failed: 'calculate_payment'
2025-08-22 11:38:47,223 - workflows.po_workflow - ERROR - Full traceback:
Traceback (most recent call last):
  File "C:\Demo Projects\PoAutomationAgent\workflows\po_workflow.py", line 1285, in process_po
    result = await self.workflow.ainvoke(initial_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 3112, in ainvoke
    async for chunk in self.astream(
    ...<29 lines>...
            chunks.append(chunk)
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 2939, in astream
    async for _ in runner.atick(
    ...<13 lines>...
            yield o
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_runner.py", line 295, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 712, in ainvoke
    input = await step.ainvoke(input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 192, in _aroute
    return self._finish(writer, input, result, config)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 205, in _finish
    r if isinstance(r, Send) else self.ends[r] for r in result
                                  ~~~~~~~~~^^^
KeyError: 'calculate_payment'
During task with name 'calculate_payment' and id '5d87afb6-ee07-8434-7e17-3248d1baf23d'
2025-08-22 11:38:47,237 - __main__ - INFO - PO  processed in 89.27s - Decision: ERROR
2025-08-22 11:38:47,237 - __main__ - WARNING - PO  error: Workflow execution failed: 'calculate_payment'
2025-08-22 11:38:48,247 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-22 11:38:48,248 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-22 11:38:48,249 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-22 11:38:50,965 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 11:38:50,967 - workflows.po_workflow - INFO - PO validation completed for PO-20250822113848
2025-08-22 11:38:50,969 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822113848
2025-08-22 11:39:13,011 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822113848
2025-08-22 11:39:13,012 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822113848
2025-08-22 11:39:26,505 - workflows.po_workflow - WARNING - Budget check failed for PO-20250822113848
2025-08-22 11:39:26,506 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822113848
2025-08-22 11:39:47,880 - workflows.po_workflow - INFO - Approval requests sent for PO-20250822113848
2025-08-22 11:39:47,883 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822113848
2025-08-22 11:40:01,788 - workflows.po_workflow - ERROR - Workflow execution failed: 'calculate_payment'
2025-08-22 11:40:01,789 - workflows.po_workflow - ERROR - Full traceback:
Traceback (most recent call last):
  File "C:\Demo Projects\PoAutomationAgent\workflows\po_workflow.py", line 1285, in process_po
    result = await self.workflow.ainvoke(initial_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 3112, in ainvoke
    async for chunk in self.astream(
    ...<29 lines>...
            chunks.append(chunk)
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 2939, in astream
    async for _ in runner.atick(
    ...<13 lines>...
            yield o
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_runner.py", line 295, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 712, in ainvoke
    input = await step.ainvoke(input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 192, in _aroute
    return self._finish(writer, input, result, config)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 205, in _finish
    r if isinstance(r, Send) else self.ends[r] for r in result
                                  ~~~~~~~~~^^^
KeyError: 'calculate_payment'
During task with name 'calculate_payment' and id '32bd8a48-3348-9968-a417-5f656b428163'
2025-08-22 11:40:01,796 - __main__ - INFO - PO  processed in 73.55s - Decision: ERROR
2025-08-22 11:40:01,797 - __main__ - WARNING - PO  error: Workflow execution failed: 'calculate_payment'
2025-08-22 11:40:02,801 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-22 11:40:02,801 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-22 11:40:02,802 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-22 11:40:05,901 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 11:40:05,903 - workflows.po_workflow - INFO - PO validation completed for PO-20250822114002
2025-08-22 11:40:05,905 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822114002
2025-08-22 11:40:28,272 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822114002
2025-08-22 11:40:28,276 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822114002
2025-08-22 11:40:50,880 - workflows.po_workflow - INFO - Budget reserved for PO-20250822114002
2025-08-22 11:40:50,882 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822114002
2025-08-22 11:41:06,439 - workflows.po_workflow - INFO - PO PO-20250822114002 auto-approved
2025-08-22 11:41:06,442 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822114002
2025-08-22 11:41:21,579 - workflows.po_workflow - ERROR - Workflow execution failed: 'calculate_payment'
2025-08-22 11:41:21,579 - workflows.po_workflow - ERROR - Full traceback:
Traceback (most recent call last):
  File "C:\Demo Projects\PoAutomationAgent\workflows\po_workflow.py", line 1285, in process_po
    result = await self.workflow.ainvoke(initial_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 3112, in ainvoke
    async for chunk in self.astream(
    ...<29 lines>...
            chunks.append(chunk)
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 2939, in astream
    async for _ in runner.atick(
    ...<13 lines>...
            yield o
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_runner.py", line 295, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 712, in ainvoke
    input = await step.ainvoke(input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 192, in _aroute
    return self._finish(writer, input, result, config)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 205, in _finish
    r if isinstance(r, Send) else self.ends[r] for r in result
                                  ~~~~~~~~~^^^
KeyError: 'calculate_payment'
During task with name 'calculate_payment' and id 'ec1c7528-870d-1d4a-2759-51202e43be45'
2025-08-22 11:41:21,587 - __main__ - INFO - PO  processed in 78.79s - Decision: ERROR
2025-08-22 11:41:21,587 - __main__ - WARNING - PO  error: Workflow execution failed: 'calculate_payment'
2025-08-22 11:41:22,600 - __main__ - INFO - Processing PO 4 for supplier SUP999
2025-08-22 11:41:22,600 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP999
2025-08-22 11:41:22,602 - workflows.po_workflow - INFO - Starting PO validation for request: SUP999
2025-08-22 11:41:25,061 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 11:41:25,066 - workflows.po_workflow - INFO - PO validation completed for PO-20250822114122
2025-08-22 11:41:25,069 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822114122
2025-08-22 11:41:46,248 - workflows.po_workflow - WARNING - Supplier validation failed for PO-20250822114122
2025-08-22 11:41:46,250 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822114122
2025-08-22 11:42:00,705 - workflows.po_workflow - WARNING - Budget check failed for PO-20250822114122
2025-08-22 11:42:00,708 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822114122
2025-08-22 11:42:22,328 - workflows.po_workflow - INFO - Approval requests sent for PO-20250822114122
2025-08-22 11:42:22,331 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822114122
2025-08-22 11:42:36,715 - workflows.po_workflow - ERROR - Workflow execution failed: 'calculate_payment'
2025-08-22 11:42:36,715 - workflows.po_workflow - ERROR - Full traceback:
Traceback (most recent call last):
  File "C:\Demo Projects\PoAutomationAgent\workflows\po_workflow.py", line 1285, in process_po
    result = await self.workflow.ainvoke(initial_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 3112, in ainvoke
    async for chunk in self.astream(
    ...<29 lines>...
            chunks.append(chunk)
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 2939, in astream
    async for _ in runner.atick(
    ...<13 lines>...
            yield o
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_runner.py", line 295, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 712, in ainvoke
    input = await step.ainvoke(input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 192, in _aroute
    return self._finish(writer, input, result, config)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 205, in _finish
    r if isinstance(r, Send) else self.ends[r] for r in result
                                  ~~~~~~~~~^^^
KeyError: 'calculate_payment'
During task with name 'calculate_payment' and id '60aac85a-db96-4e2c-eb16-5172b475b692'
2025-08-22 11:42:36,735 - __main__ - INFO - PO  processed in 74.13s - Decision: ERROR
2025-08-22 11:42:36,736 - __main__ - WARNING - PO  error: Workflow execution failed: 'calculate_payment'
2025-08-22 11:42:37,766 - database.db_operations - INFO - Database manager closed
2025-08-22 11:42:37,768 - __main__ - INFO - PO Automation System closed
2025-08-22 11:59:28,094 - __main__ - INFO - Initializing PO Automation System...
2025-08-22 11:59:28,095 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-22 11:59:28,095 - __main__ - INFO - PO Automation System initialized successfully
2025-08-22 11:59:29,489 - database.db_operations - INFO - Found 4 purchase orders
2025-08-22 11:59:29,770 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-22 11:59:29,770 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-22 11:59:29,801 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-22 11:59:29,812 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-22 11:59:32,304 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 11:59:32,320 - workflows.po_workflow - INFO - PO validation completed for PO-20250822115929
2025-08-22 11:59:32,323 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822115929
2025-08-22 12:00:05,752 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822115929
2025-08-22 12:00:05,754 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822115929
2025-08-22 12:00:19,309 - workflows.po_workflow - WARNING - Budget check failed for PO-20250822115929
2025-08-22 12:00:19,311 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822115929
2025-08-22 12:00:40,010 - workflows.po_workflow - INFO - Approval requests sent for PO-20250822115929
2025-08-22 12:00:40,011 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822115929
2025-08-22 12:00:53,386 - workflows.po_workflow - ERROR - Workflow execution failed: 'calculate_payment'
2025-08-22 12:00:53,387 - workflows.po_workflow - ERROR - Full traceback:
Traceback (most recent call last):
  File "C:\Demo Projects\PoAutomationAgent\workflows\po_workflow.py", line 1303, in process_po
    result = await self.workflow.ainvoke(initial_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 3112, in ainvoke
    async for chunk in self.astream(
    ...<29 lines>...
            chunks.append(chunk)
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 2939, in astream
    async for _ in runner.atick(
    ...<13 lines>...
            yield o
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_runner.py", line 295, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 712, in ainvoke
    input = await step.ainvoke(input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 192, in _aroute
    return self._finish(writer, input, result, config)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 205, in _finish
    r if isinstance(r, Send) else self.ends[r] for r in result
                                  ~~~~~~~~~^^^
KeyError: 'calculate_payment'
During task with name 'calculate_payment' and id '5551996e-54c0-19d8-a7ca-5470031a676d'
2025-08-22 12:00:53,434 - __main__ - INFO - PO  processed in 83.66s - Decision: ERROR
2025-08-22 12:00:53,434 - __main__ - WARNING - PO  error: Workflow execution failed: 'calculate_payment'
2025-08-22 12:00:54,441 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-22 12:00:54,442 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-22 12:00:54,444 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-22 12:00:56,401 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 12:00:56,404 - workflows.po_workflow - INFO - PO validation completed for PO-20250822120054
2025-08-22 12:00:56,405 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822120054
2025-08-22 12:01:15,956 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822120054
2025-08-22 12:01:15,959 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822120054
2025-08-22 12:01:29,274 - workflows.po_workflow - WARNING - Budget check failed for PO-20250822120054
2025-08-22 12:01:29,275 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822120054
2025-08-22 12:01:48,717 - workflows.po_workflow - INFO - Approval requests sent for PO-20250822120054
2025-08-22 12:01:48,719 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822120054
2025-08-22 12:02:02,290 - workflows.po_workflow - ERROR - Workflow execution failed: 'calculate_payment'
2025-08-22 12:02:02,291 - workflows.po_workflow - ERROR - Full traceback:
Traceback (most recent call last):
  File "C:\Demo Projects\PoAutomationAgent\workflows\po_workflow.py", line 1303, in process_po
    result = await self.workflow.ainvoke(initial_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 3112, in ainvoke
    async for chunk in self.astream(
    ...<29 lines>...
            chunks.append(chunk)
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 2939, in astream
    async for _ in runner.atick(
    ...<13 lines>...
            yield o
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_runner.py", line 295, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 712, in ainvoke
    input = await step.ainvoke(input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 192, in _aroute
    return self._finish(writer, input, result, config)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 205, in _finish
    r if isinstance(r, Send) else self.ends[r] for r in result
                                  ~~~~~~~~~^^^
KeyError: 'calculate_payment'
During task with name 'calculate_payment' and id '6169e543-0f60-dcc0-c4e0-a2c9829cf55f'
2025-08-22 12:02:02,297 - __main__ - INFO - PO  processed in 67.86s - Decision: ERROR
2025-08-22 12:02:02,298 - __main__ - WARNING - PO  error: Workflow execution failed: 'calculate_payment'
2025-08-22 12:02:03,306 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-22 12:02:03,307 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-22 12:02:03,309 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-22 12:02:05,129 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 12:02:05,133 - workflows.po_workflow - INFO - PO validation completed for PO-20250822120203
2025-08-22 12:02:05,135 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822120203
2025-08-22 12:02:25,079 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822120203
2025-08-22 12:02:25,080 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822120203
2025-08-22 12:02:44,473 - workflows.po_workflow - INFO - Budget reserved for PO-20250822120203
2025-08-22 12:02:44,476 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822120203
2025-08-22 12:02:58,399 - workflows.po_workflow - INFO - PO PO-20250822120203 auto-approved
2025-08-22 12:02:58,401 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822120203
2025-08-22 12:03:13,998 - workflows.po_workflow - ERROR - Workflow execution failed: 'calculate_payment'
2025-08-22 12:03:13,999 - workflows.po_workflow - ERROR - Full traceback:
Traceback (most recent call last):
  File "C:\Demo Projects\PoAutomationAgent\workflows\po_workflow.py", line 1303, in process_po
    result = await self.workflow.ainvoke(initial_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 3112, in ainvoke
    async for chunk in self.astream(
    ...<29 lines>...
            chunks.append(chunk)
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 2939, in astream
    async for _ in runner.atick(
    ...<13 lines>...
            yield o
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_runner.py", line 295, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 712, in ainvoke
    input = await step.ainvoke(input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 192, in _aroute
    return self._finish(writer, input, result, config)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 205, in _finish
    r if isinstance(r, Send) else self.ends[r] for r in result
                                  ~~~~~~~~~^^^
KeyError: 'calculate_payment'
During task with name 'calculate_payment' and id 'e115c9c8-95c0-b8cc-a4a8-60b881d2977f'
2025-08-22 12:03:14,004 - __main__ - INFO - PO  processed in 70.70s - Decision: ERROR
2025-08-22 12:03:14,004 - __main__ - WARNING - PO  error: Workflow execution failed: 'calculate_payment'
2025-08-22 12:03:15,018 - __main__ - INFO - Processing PO 4 for supplier SUP999
2025-08-22 12:03:15,019 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP999
2025-08-22 12:03:15,021 - workflows.po_workflow - INFO - Starting PO validation for request: SUP999
2025-08-22 12:03:17,467 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 12:03:17,470 - workflows.po_workflow - INFO - PO validation completed for PO-20250822120315
2025-08-22 12:03:17,472 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822120315
2025-08-22 12:03:40,555 - workflows.po_workflow - WARNING - Supplier validation failed for PO-20250822120315
2025-08-22 12:03:40,557 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822120315
2025-08-22 12:03:55,115 - workflows.po_workflow - WARNING - Budget check failed for PO-20250822120315
2025-08-22 12:03:55,117 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822120315
2025-08-22 12:04:17,783 - workflows.po_workflow - INFO - Approval requests sent for PO-20250822120315
2025-08-22 12:04:17,785 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822120315
2025-08-22 12:04:35,932 - workflows.po_workflow - ERROR - Workflow execution failed: 'calculate_payment'
2025-08-22 12:04:35,933 - workflows.po_workflow - ERROR - Full traceback:
Traceback (most recent call last):
  File "C:\Demo Projects\PoAutomationAgent\workflows\po_workflow.py", line 1303, in process_po
    result = await self.workflow.ainvoke(initial_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 3112, in ainvoke
    async for chunk in self.astream(
    ...<29 lines>...
            chunks.append(chunk)
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 2939, in astream
    async for _ in runner.atick(
    ...<13 lines>...
            yield o
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_runner.py", line 295, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 712, in ainvoke
    input = await step.ainvoke(input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 192, in _aroute
    return self._finish(writer, input, result, config)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 205, in _finish
    r if isinstance(r, Send) else self.ends[r] for r in result
                                  ~~~~~~~~~^^^
KeyError: 'calculate_payment'
During task with name 'calculate_payment' and id '6af41b73-823c-83f1-678d-419eabba4f0b'
2025-08-22 12:04:35,938 - __main__ - INFO - PO  processed in 80.92s - Decision: ERROR
2025-08-22 12:04:35,938 - __main__ - WARNING - PO  error: Workflow execution failed: 'calculate_payment'
2025-08-22 12:04:36,946 - database.db_operations - INFO - Database manager closed
2025-08-22 12:04:36,947 - __main__ - INFO - PO Automation System closed
2025-08-22 12:07:50,271 - __main__ - INFO - Initializing PO Automation System...
2025-08-22 12:07:50,272 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-22 12:07:50,272 - __main__ - INFO - PO Automation System initialized successfully
2025-08-22 12:07:51,400 - database.db_operations - INFO - Found 4 purchase orders
2025-08-22 12:07:51,692 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-22 12:07:51,692 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-22 12:07:51,711 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-22 12:07:51,729 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-22 12:07:54,342 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 12:07:54,350 - workflows.po_workflow - INFO - PO validation completed for PO-20250822120751
2025-08-22 12:07:54,352 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822120751
2025-08-22 12:08:13,503 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822120751
2025-08-22 12:08:13,505 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822120751
2025-08-22 12:08:27,562 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822120751
2025-08-22 12:08:48,080 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822120751
2025-08-22 12:09:01,275 - workflows.po_workflow - ERROR - Workflow execution failed: 'calculate_payment'
2025-08-22 12:09:01,275 - workflows.po_workflow - ERROR - Full traceback:
Traceback (most recent call last):
  File "C:\Demo Projects\PoAutomationAgent\workflows\po_workflow.py", line 1154, in process_po
    result = await self.workflow.ainvoke(initial_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 3112, in ainvoke
    async for chunk in self.astream(
    ...<29 lines>...
            chunks.append(chunk)
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 2939, in astream
    async for _ in runner.atick(
    ...<13 lines>...
            yield o
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_runner.py", line 295, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 712, in ainvoke
    input = await step.ainvoke(input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 192, in _aroute
    return self._finish(writer, input, result, config)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 205, in _finish
    r if isinstance(r, Send) else self.ends[r] for r in result
                                  ~~~~~~~~~^^^
KeyError: 'calculate_payment'
During task with name 'calculate_payment' and id 'afac6483-e169-c858-d57b-ca1bda5fb159'
2025-08-22 12:09:01,286 - __main__ - INFO - PO  processed in 69.59s - Decision: ERROR
2025-08-22 12:09:01,286 - __main__ - WARNING - PO  error: Workflow execution failed: 'calculate_payment'
2025-08-22 12:09:02,296 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-22 12:09:02,296 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-22 12:09:02,297 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-22 12:09:04,180 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 12:09:04,182 - workflows.po_workflow - INFO - PO validation completed for PO-20250822120902
2025-08-22 12:09:04,183 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822120902
2025-08-22 12:09:23,450 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822120902
2025-08-22 12:09:23,452 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822120902
2025-08-22 12:09:36,629 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822120902
2025-08-22 12:09:55,729 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822120902
2025-08-22 12:10:08,390 - workflows.po_workflow - ERROR - Workflow execution failed: 'calculate_payment'
2025-08-22 12:10:08,391 - workflows.po_workflow - ERROR - Full traceback:
Traceback (most recent call last):
  File "C:\Demo Projects\PoAutomationAgent\workflows\po_workflow.py", line 1154, in process_po
    result = await self.workflow.ainvoke(initial_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 3112, in ainvoke
    async for chunk in self.astream(
    ...<29 lines>...
            chunks.append(chunk)
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 2939, in astream
    async for _ in runner.atick(
    ...<13 lines>...
            yield o
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_runner.py", line 295, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 712, in ainvoke
    input = await step.ainvoke(input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 192, in _aroute
    return self._finish(writer, input, result, config)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 205, in _finish
    r if isinstance(r, Send) else self.ends[r] for r in result
                                  ~~~~~~~~~^^^
KeyError: 'calculate_payment'
During task with name 'calculate_payment' and id 'b62c667d-90ce-a443-b855-2c15ebae2483'
2025-08-22 12:10:08,399 - __main__ - INFO - PO  processed in 66.10s - Decision: ERROR
2025-08-22 12:10:08,400 - __main__ - WARNING - PO  error: Workflow execution failed: 'calculate_payment'
2025-08-22 12:10:09,414 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-22 12:10:09,415 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-22 12:10:09,417 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-22 12:10:11,938 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 12:10:11,941 - workflows.po_workflow - INFO - PO validation completed for PO-20250822121009
2025-08-22 12:10:11,944 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822121009
2025-08-22 12:10:32,641 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822121009
2025-08-22 12:10:32,643 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822121009
2025-08-22 12:10:53,646 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822121009
2025-08-22 12:11:06,710 - workflows.po_workflow - INFO - PO PO-20250822121009 auto-approved
2025-08-22 12:11:06,712 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822121009
2025-08-22 12:11:20,576 - workflows.po_workflow - ERROR - Workflow execution failed: 'calculate_payment'
2025-08-22 12:11:20,576 - workflows.po_workflow - ERROR - Full traceback:
Traceback (most recent call last):
  File "C:\Demo Projects\PoAutomationAgent\workflows\po_workflow.py", line 1154, in process_po
    result = await self.workflow.ainvoke(initial_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 3112, in ainvoke
    async for chunk in self.astream(
    ...<29 lines>...
            chunks.append(chunk)
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 2939, in astream
    async for _ in runner.atick(
    ...<13 lines>...
            yield o
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_runner.py", line 295, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 712, in ainvoke
    input = await step.ainvoke(input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 192, in _aroute
    return self._finish(writer, input, result, config)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 205, in _finish
    r if isinstance(r, Send) else self.ends[r] for r in result
                                  ~~~~~~~~~^^^
KeyError: 'calculate_payment'
During task with name 'calculate_payment' and id '06d142da-5347-1833-7d59-92f0deb41710'
2025-08-22 12:11:20,579 - __main__ - INFO - PO  processed in 71.16s - Decision: ERROR
2025-08-22 12:11:20,579 - __main__ - WARNING - PO  error: Workflow execution failed: 'calculate_payment'
2025-08-22 12:11:21,592 - __main__ - INFO - Processing PO 4 for supplier SUP999
2025-08-22 12:11:21,592 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP999
2025-08-22 12:11:21,593 - workflows.po_workflow - INFO - Starting PO validation for request: SUP999
2025-08-22 12:11:23,844 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 12:11:23,846 - workflows.po_workflow - INFO - PO validation completed for PO-20250822121121
2025-08-22 12:11:23,847 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822121121
2025-08-22 12:11:46,029 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822121121
2025-08-22 12:11:59,558 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822121121
2025-08-22 12:12:19,824 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822121121
2025-08-22 12:12:33,403 - workflows.po_workflow - ERROR - Workflow execution failed: 'calculate_payment'
2025-08-22 12:12:33,403 - workflows.po_workflow - ERROR - Full traceback:
Traceback (most recent call last):
  File "C:\Demo Projects\PoAutomationAgent\workflows\po_workflow.py", line 1154, in process_po
    result = await self.workflow.ainvoke(initial_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 3112, in ainvoke
    async for chunk in self.astream(
    ...<29 lines>...
            chunks.append(chunk)
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 2939, in astream
    async for _ in runner.atick(
    ...<13 lines>...
            yield o
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_runner.py", line 295, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 712, in ainvoke
    input = await step.ainvoke(input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 192, in _aroute
    return self._finish(writer, input, result, config)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 205, in _finish
    r if isinstance(r, Send) else self.ends[r] for r in result
                                  ~~~~~~~~~^^^
KeyError: 'calculate_payment'
During task with name 'calculate_payment' and id '4e5b9d73-a1df-2f18-f439-349acb02191b'
2025-08-22 12:12:33,410 - __main__ - INFO - PO  processed in 71.82s - Decision: ERROR
2025-08-22 12:12:33,410 - __main__ - WARNING - PO  error: Workflow execution failed: 'calculate_payment'
2025-08-22 12:12:34,424 - database.db_operations - INFO - Database manager closed
2025-08-22 12:12:34,425 - __main__ - INFO - PO Automation System closed
2025-08-22 12:15:16,850 - __main__ - INFO - Initializing PO Automation System...
2025-08-22 12:15:16,850 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-22 12:15:16,851 - __main__ - INFO - PO Automation System initialized successfully
2025-08-22 12:15:17,951 - database.db_operations - INFO - Found 4 purchase orders
2025-08-22 12:15:18,238 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-22 12:15:18,239 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-22 12:15:18,268 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-22 12:15:18,274 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-22 12:15:20,553 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 12:15:20,559 - workflows.po_workflow - INFO - PO validation completed for PO-20250822121518
2025-08-22 12:15:20,561 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822121518
2025-08-22 12:15:39,556 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822121518
2025-08-22 12:15:39,557 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822121518
2025-08-22 12:15:52,314 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822121518
2025-08-22 12:16:11,334 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822121518
2025-08-22 12:16:23,982 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822121518
2025-08-22 12:16:30,495 - workflows.po_workflow - INFO - Notifications sent for PO-20250822121518
2025-08-22 12:16:30,497 - workflows.po_workflow - INFO - PO processing completed for PO-20250822121518 in 72.26s
2025-08-22 12:16:30,497 - __main__ - INFO - PO PO-20250822121518 processed in 72.26s - Decision: ERROR
2025-08-22 12:16:30,497 - __main__ - WARNING - PO PO-20250822121518 error: Payment plan error: recommend_payment_plan failed: No supported fetch_all/query_all/execute_query found in DB layer
2025-08-22 12:16:31,510 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-22 12:16:31,511 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-22 12:16:31,512 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-22 12:16:33,478 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 12:16:33,480 - workflows.po_workflow - INFO - PO validation completed for PO-20250822121631
2025-08-22 12:16:33,482 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822121631
2025-08-22 12:16:52,293 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822121631
2025-08-22 12:16:52,295 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822121631
2025-08-22 12:17:04,786 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822121631
2025-08-22 12:17:24,311 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822121631
2025-08-22 12:17:36,311 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822121631
2025-08-22 12:17:42,887 - workflows.po_workflow - INFO - Notifications sent for PO-20250822121631
2025-08-22 12:17:42,888 - workflows.po_workflow - INFO - PO processing completed for PO-20250822121631 in 71.38s
2025-08-22 12:17:42,888 - __main__ - INFO - PO PO-20250822121631 processed in 71.38s - Decision: ERROR
2025-08-22 12:17:42,888 - __main__ - WARNING - PO PO-20250822121631 error: Payment plan error: recommend_payment_plan failed: No supported fetch_all/query_all/execute_query found in DB layer
2025-08-22 12:17:43,895 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-22 12:17:43,895 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-22 12:17:43,896 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-22 12:17:45,832 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 12:17:45,833 - workflows.po_workflow - INFO - PO validation completed for PO-20250822121743
2025-08-22 12:17:45,834 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822121743
2025-08-22 12:18:04,527 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822121743
2025-08-22 12:18:04,528 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822121743
2025-08-22 12:18:23,520 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822121743
2025-08-22 12:18:35,880 - workflows.po_workflow - INFO - PO PO-20250822121743 auto-approved
2025-08-22 12:18:35,881 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822121743
2025-08-22 12:18:48,340 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822121743
2025-08-22 12:18:54,825 - workflows.po_workflow - INFO - Notifications sent for PO-20250822121743
2025-08-22 12:18:54,826 - workflows.po_workflow - INFO - PO processing completed for PO-20250822121743 in 70.93s
2025-08-22 12:18:54,826 - __main__ - INFO - PO PO-20250822121743 processed in 70.93s - Decision: ERROR
2025-08-22 12:18:54,826 - __main__ - WARNING - PO PO-20250822121743 error: Payment plan error: recommend_payment_plan failed: No supported fetch_all/query_all/execute_query found in DB layer
2025-08-22 12:18:55,841 - __main__ - INFO - Processing PO 4 for supplier SUP999
2025-08-22 12:18:55,841 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP999
2025-08-22 12:18:55,842 - workflows.po_workflow - INFO - Starting PO validation for request: SUP999
2025-08-22 12:19:00,618 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 12:19:00,621 - workflows.po_workflow - INFO - PO validation completed for PO-20250822121855
2025-08-22 12:19:00,623 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822121855
2025-08-22 12:19:19,471 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822121855
2025-08-22 12:19:32,935 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822121855
2025-08-22 12:19:51,939 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822121855
2025-08-22 12:20:05,011 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822121855
2025-08-22 12:20:11,891 - workflows.po_workflow - INFO - Notifications sent for PO-20250822121855
2025-08-22 12:20:11,893 - workflows.po_workflow - INFO - PO processing completed for PO-20250822121855 in 76.05s
2025-08-22 12:20:11,893 - __main__ - INFO - PO PO-20250822121855 processed in 76.05s - Decision: ERROR
2025-08-22 12:20:11,894 - __main__ - WARNING - PO PO-20250822121855 error: Payment plan error: recommend_payment_plan failed: No supported fetch_all/query_all/execute_query found in DB layer
2025-08-22 12:20:12,901 - database.db_operations - INFO - Database manager closed
2025-08-22 12:20:12,902 - __main__ - INFO - PO Automation System closed
2025-08-22 12:30:31,006 - __main__ - INFO - Initializing PO Automation System...
2025-08-22 12:30:31,007 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-22 12:30:31,007 - __main__ - INFO - PO Automation System initialized successfully
2025-08-22 12:30:32,191 - database.db_operations - INFO - Found 4 purchase orders
2025-08-22 12:30:32,543 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-22 12:30:32,543 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-22 12:30:32,576 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-22 12:30:32,584 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-22 12:30:35,140 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 12:30:35,153 - workflows.po_workflow - INFO - PO validation completed for PO-20250822123032
2025-08-22 12:30:35,155 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822123032
2025-08-22 12:30:54,055 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822123032
2025-08-22 12:30:54,057 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822123032
2025-08-22 12:31:06,979 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822123032
2025-08-22 12:31:26,437 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822123032
2025-08-22 12:31:28,694 - workflows.po_workflow - ERROR - Error getting tools from payment: unhandled errors in a TaskGroup (1 sub-exception)
2025-08-22 12:31:28,694 - workflows.po_workflow - ERROR - Error during payment calculation: Payment tool 'recommend_payment_plan' not found. Available: []
2025-08-22 12:31:28,695 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822123032
2025-08-22 12:31:35,845 - workflows.po_workflow - INFO - Notifications sent for PO-20250822123032
2025-08-22 12:31:35,848 - workflows.po_workflow - INFO - PO processing completed for PO-20250822123032 in 63.30s
2025-08-22 12:31:35,848 - __main__ - INFO - PO PO-20250822123032 processed in 63.30s - Decision: ERROR
2025-08-22 12:31:35,848 - __main__ - WARNING - PO PO-20250822123032 error: Error during payment calculation: Payment tool 'recommend_payment_plan' not found. Available: []
2025-08-22 12:31:36,854 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-22 12:31:36,855 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-22 12:31:36,856 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-22 12:31:38,898 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 12:31:38,900 - workflows.po_workflow - INFO - PO validation completed for PO-20250822123136
2025-08-22 12:31:38,903 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822123136
2025-08-22 12:31:59,567 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822123136
2025-08-22 12:31:59,569 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822123136
2025-08-22 12:32:13,375 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822123136
2025-08-22 12:32:34,889 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822123136
2025-08-22 12:32:37,361 - workflows.po_workflow - ERROR - Error getting tools from payment: unhandled errors in a TaskGroup (1 sub-exception)
2025-08-22 12:32:37,362 - workflows.po_workflow - ERROR - Error during payment calculation: Payment tool 'recommend_payment_plan' not found. Available: []
2025-08-22 12:32:37,364 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822123136
2025-08-22 12:32:44,631 - workflows.po_workflow - INFO - Notifications sent for PO-20250822123136
2025-08-22 12:32:44,634 - workflows.po_workflow - INFO - PO processing completed for PO-20250822123136 in 67.78s
2025-08-22 12:32:44,635 - __main__ - INFO - PO PO-20250822123136 processed in 67.78s - Decision: ERROR
2025-08-22 12:32:44,635 - __main__ - WARNING - PO PO-20250822123136 error: Error during payment calculation: Payment tool 'recommend_payment_plan' not found. Available: []
2025-08-22 12:32:45,651 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-22 12:32:45,652 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-22 12:32:45,653 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-22 12:32:48,404 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 12:32:48,406 - workflows.po_workflow - INFO - PO validation completed for PO-20250822123245
2025-08-22 12:32:48,408 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822123245
2025-08-22 12:33:09,828 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822123245
2025-08-22 12:33:09,830 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822123245
2025-08-22 12:33:31,740 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822123245
2025-08-22 12:33:45,602 - workflows.po_workflow - INFO - PO PO-20250822123245 auto-approved
2025-08-22 12:33:45,605 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822123245
2025-08-22 12:33:48,101 - workflows.po_workflow - ERROR - Error getting tools from payment: unhandled errors in a TaskGroup (1 sub-exception)
2025-08-22 12:33:48,101 - workflows.po_workflow - ERROR - Error during payment calculation: Payment tool 'recommend_payment_plan' not found. Available: []
2025-08-22 12:33:48,103 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822123245
2025-08-22 12:33:55,729 - workflows.po_workflow - INFO - Notifications sent for PO-20250822123245
2025-08-22 12:33:55,731 - workflows.po_workflow - INFO - PO processing completed for PO-20250822123245 in 70.08s
2025-08-22 12:33:55,732 - __main__ - INFO - PO PO-20250822123245 processed in 70.08s - Decision: ERROR
2025-08-22 12:33:55,732 - __main__ - WARNING - PO PO-20250822123245 error: Error during payment calculation: Payment tool 'recommend_payment_plan' not found. Available: []
2025-08-22 12:33:56,743 - __main__ - INFO - Processing PO 4 for supplier SUP999
2025-08-22 12:33:56,744 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP999
2025-08-22 12:33:56,746 - workflows.po_workflow - INFO - Starting PO validation for request: SUP999
2025-08-22 12:33:58,886 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 12:33:58,889 - workflows.po_workflow - INFO - PO validation completed for PO-20250822123356
2025-08-22 12:33:58,891 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822123356
2025-08-22 12:34:24,098 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822123356
2025-08-22 12:34:40,253 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822123356
2025-08-22 12:35:04,173 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822123356
2025-08-22 12:35:06,764 - workflows.po_workflow - ERROR - Error getting tools from payment: unhandled errors in a TaskGroup (1 sub-exception)
2025-08-22 12:35:06,765 - workflows.po_workflow - ERROR - Error during payment calculation: Payment tool 'recommend_payment_plan' not found. Available: []
2025-08-22 12:35:06,767 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822123356
2025-08-22 12:35:14,784 - workflows.po_workflow - INFO - Notifications sent for PO-20250822123356
2025-08-22 12:35:14,785 - workflows.po_workflow - INFO - PO processing completed for PO-20250822123356 in 78.04s
2025-08-22 12:35:14,786 - __main__ - INFO - PO PO-20250822123356 processed in 78.04s - Decision: ERROR
2025-08-22 12:35:14,786 - __main__ - WARNING - PO PO-20250822123356 error: Error during payment calculation: Payment tool 'recommend_payment_plan' not found. Available: []
2025-08-22 12:35:15,798 - database.db_operations - INFO - Database manager closed
2025-08-22 12:35:15,799 - __main__ - INFO - PO Automation System closed
2025-08-22 12:40:30,989 - __main__ - INFO - Initializing PO Automation System...
2025-08-22 12:40:30,989 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-22 12:40:30,990 - __main__ - INFO - PO Automation System initialized successfully
2025-08-22 12:40:31,904 - database.db_operations - INFO - Found 4 purchase orders
2025-08-22 12:40:32,159 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-22 12:40:32,160 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-22 12:40:32,183 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-22 12:40:32,190 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-22 12:40:34,574 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 12:40:34,582 - workflows.po_workflow - INFO - PO validation completed for PO-20250822124032
2025-08-22 12:40:34,584 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822124032
2025-08-22 12:40:54,641 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822124032
2025-08-22 12:40:54,642 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822124032
2025-08-22 12:41:07,235 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822124032
2025-08-22 12:41:26,480 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822124032
2025-08-22 12:41:30,811 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822124032
2025-08-22 12:41:37,984 - workflows.po_workflow - INFO - Notifications sent for PO-20250822124032
2025-08-22 12:41:37,986 - workflows.po_workflow - INFO - PO processing completed for PO-20250822124032 in 65.83s
2025-08-22 12:41:37,986 - __main__ - INFO - PO PO-20250822124032 processed in 65.83s - Decision: ERROR
2025-08-22 12:41:37,987 - __main__ - WARNING - PO PO-20250822124032 error: Payment plan error: recommend_payment_plan failed: Missing required environment variables: DB_SERVER, DB_DATABASE, DB_USERNAME, DB_PASSWORD
2025-08-22 12:41:39,000 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-22 12:41:39,000 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-22 12:41:39,001 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-22 12:41:40,987 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 12:41:40,988 - workflows.po_workflow - INFO - PO validation completed for PO-20250822124139
2025-08-22 12:41:40,990 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822124139
2025-08-22 12:41:59,579 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822124139
2025-08-22 12:41:59,582 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822124139
2025-08-22 12:42:12,560 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822124139
2025-08-22 12:42:33,152 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822124139
2025-08-22 12:42:38,653 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822124139
2025-08-22 12:42:46,140 - workflows.po_workflow - INFO - Notifications sent for PO-20250822124139
2025-08-22 12:42:46,143 - workflows.po_workflow - INFO - PO processing completed for PO-20250822124139 in 67.14s
2025-08-22 12:42:46,143 - __main__ - INFO - PO PO-20250822124139 processed in 67.14s - Decision: ERROR
2025-08-22 12:42:46,143 - __main__ - WARNING - PO PO-20250822124139 error: Payment plan error: recommend_payment_plan failed: Missing required environment variables: DB_SERVER, DB_DATABASE, DB_USERNAME, DB_PASSWORD
2025-08-22 12:42:47,161 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-22 12:42:47,161 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-22 12:42:47,163 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-22 12:42:49,137 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 12:42:49,139 - workflows.po_workflow - INFO - PO validation completed for PO-20250822124247
2025-08-22 12:42:49,142 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822124247
2025-08-22 12:43:12,193 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822124247
2025-08-22 12:43:12,197 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822124247
2025-08-22 12:43:34,159 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822124247
2025-08-22 12:43:48,818 - workflows.po_workflow - INFO - PO PO-20250822124247 auto-approved
2025-08-22 12:43:48,820 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822124247
2025-08-22 12:43:54,476 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822124247
2025-08-22 12:44:02,463 - workflows.po_workflow - INFO - Notifications sent for PO-20250822124247
2025-08-22 12:44:02,465 - workflows.po_workflow - INFO - PO processing completed for PO-20250822124247 in 75.30s
2025-08-22 12:44:02,466 - __main__ - INFO - PO PO-20250822124247 processed in 75.30s - Decision: ERROR
2025-08-22 12:44:02,466 - __main__ - WARNING - PO PO-20250822124247 error: Payment plan error: recommend_payment_plan failed: Missing required environment variables: DB_SERVER, DB_DATABASE, DB_USERNAME, DB_PASSWORD
2025-08-22 12:44:03,473 - __main__ - INFO - Processing PO 4 for supplier SUP999
2025-08-22 12:44:03,473 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP999
2025-08-22 12:44:03,475 - workflows.po_workflow - INFO - Starting PO validation for request: SUP999
2025-08-22 12:44:05,729 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 12:44:05,731 - workflows.po_workflow - INFO - PO validation completed for PO-20250822124403
2025-08-22 12:44:05,734 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822124403
2025-08-22 12:44:25,747 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822124403
2025-08-22 12:44:39,058 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822124403
2025-08-22 12:45:01,757 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822124403
2025-08-22 12:45:07,987 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822124403
2025-08-22 12:45:15,676 - workflows.po_workflow - INFO - Notifications sent for PO-20250822124403
2025-08-22 12:45:15,678 - workflows.po_workflow - INFO - PO processing completed for PO-20250822124403 in 72.21s
2025-08-22 12:45:15,679 - __main__ - INFO - PO PO-20250822124403 processed in 72.21s - Decision: ERROR
2025-08-22 12:45:15,679 - __main__ - WARNING - PO PO-20250822124403 error: Payment plan error: recommend_payment_plan failed: Missing required environment variables: DB_SERVER, DB_DATABASE, DB_USERNAME, DB_PASSWORD
2025-08-22 12:45:16,698 - database.db_operations - INFO - Database manager closed
2025-08-22 12:45:16,699 - __main__ - INFO - PO Automation System closed
2025-08-22 12:51:36,093 - __main__ - INFO - Initializing PO Automation System...
2025-08-22 12:51:36,094 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-22 12:51:36,094 - __main__ - INFO - PO Automation System initialized successfully
2025-08-22 12:51:37,458 - database.db_operations - INFO - Found 4 purchase orders
2025-08-22 12:51:37,668 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-22 12:51:37,668 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-22 12:51:37,694 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-22 12:51:37,702 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-22 12:51:40,505 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 12:51:40,512 - workflows.po_workflow - INFO - PO validation completed for PO-20250822125137
2025-08-22 12:51:40,514 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822125137
2025-08-22 12:51:59,117 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822125137
2025-08-22 12:51:59,118 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822125137
2025-08-22 12:52:12,585 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822125137
2025-08-22 12:52:31,792 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822125137
2025-08-22 12:52:37,817 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822125137
2025-08-22 12:52:44,467 - workflows.po_workflow - INFO - Notifications sent for PO-20250822125137
2025-08-22 12:52:44,468 - workflows.po_workflow - INFO - PO processing completed for PO-20250822125137 in 66.80s
2025-08-22 12:52:44,468 - __main__ - INFO - PO PO-20250822125137 processed in 66.80s - Decision: ERROR
2025-08-22 12:52:44,469 - __main__ - WARNING - PO PO-20250822125137 error: Payment plan error: recommend_payment_plan failed: (207, b"Invalid column name 'curr'.DB-Lib error message 20018, severity 16:\nGeneral SQL Server error: Check messages from the SQL Server\n")
2025-08-22 12:52:45,476 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-22 12:52:45,477 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-22 12:52:45,478 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-22 12:52:47,260 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 12:52:47,262 - workflows.po_workflow - INFO - PO validation completed for PO-20250822125245
2025-08-22 12:52:47,263 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822125245
2025-08-22 12:53:06,455 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822125245
2025-08-22 12:53:06,457 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822125245
2025-08-22 13:50:21,604 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822125245
2025-08-22 13:50:53,571 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822125245
2025-08-22 13:51:21,275 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822125245
2025-08-22 13:51:30,243 - workflows.po_workflow - INFO - Notifications sent for PO-20250822125245
2025-08-22 13:51:30,248 - workflows.po_workflow - INFO - PO processing completed for PO-20250822125245 in 3524.77s
2025-08-22 13:51:30,249 - __main__ - INFO - PO PO-20250822125245 processed in 3524.77s - Decision: ERROR
2025-08-22 13:51:30,250 - __main__ - WARNING - PO PO-20250822125245 error: Payment plan error: recommend_payment_plan failed: (20009, b'DB-Lib error message 20009, severity 9:\nUnable to connect: Adaptive Server is unavailable or does not exist (axisdmt.database.windows.net)\nNet-Lib error during Unknown error (10060)\nDB-Lib error message 20009, severity 9:\nUnable to connect: Adaptive Server is unavailable or does not exist (axisdmt.database.windows.net)\nNet-Lib error during Unknown error (10060)\n')
2025-08-22 13:51:31,263 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-22 13:51:31,263 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-22 13:51:31,266 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-22 13:51:32,988 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 13:51:32,992 - workflows.po_workflow - INFO - PO validation completed for PO-20250822135131
2025-08-22 13:51:32,995 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822135131
2025-08-22 13:51:55,754 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822135131
2025-08-22 13:51:55,756 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822135131
2025-08-22 13:52:22,085 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822135131
2025-08-22 13:52:38,981 - workflows.po_workflow - INFO - PO PO-20250822135131 auto-approved
2025-08-22 13:52:38,983 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822135131
2025-08-22 13:52:45,401 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822135131
2025-08-22 13:52:53,077 - workflows.po_workflow - INFO - Notifications sent for PO-20250822135131
2025-08-22 13:52:53,080 - workflows.po_workflow - INFO - PO processing completed for PO-20250822135131 in 81.82s
2025-08-22 13:52:53,080 - __main__ - INFO - PO PO-20250822135131 processed in 81.82s - Decision: ERROR
2025-08-22 13:52:53,080 - __main__ - WARNING - PO PO-20250822135131 error: Payment plan error: recommend_payment_plan failed: (207, b"Invalid column name 'curr'.DB-Lib error message 20018, severity 16:\nGeneral SQL Server error: Check messages from the SQL Server\n")
2025-08-22 13:52:54,090 - __main__ - INFO - Processing PO 4 for supplier SUP999
2025-08-22 13:52:54,090 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP999
2025-08-22 13:52:54,092 - workflows.po_workflow - INFO - Starting PO validation for request: SUP999
2025-08-22 13:52:58,385 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 13:52:58,387 - workflows.po_workflow - INFO - PO validation completed for PO-20250822135254
2025-08-22 13:52:58,388 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822135254
2025-08-22 13:53:20,233 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822135254
2025-08-22 13:53:34,754 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822135254
2025-08-22 13:53:57,355 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822135254
2025-08-22 13:54:04,871 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822135254
2025-08-22 13:54:13,115 - workflows.po_workflow - INFO - Notifications sent for PO-20250822135254
2025-08-22 13:54:13,118 - workflows.po_workflow - INFO - PO processing completed for PO-20250822135254 in 79.03s
2025-08-22 13:54:13,118 - __main__ - INFO - PO PO-20250822135254 processed in 79.03s - Decision: ERROR
2025-08-22 13:54:13,119 - __main__ - WARNING - PO PO-20250822135254 error: Payment plan error: recommend_payment_plan failed: (207, b"Invalid column name 'curr'.DB-Lib error message 20018, severity 16:\nGeneral SQL Server error: Check messages from the SQL Server\n")
2025-08-22 13:54:14,135 - database.db_operations - INFO - Database manager closed
2025-08-22 13:54:14,137 - __main__ - INFO - PO Automation System closed
2025-08-22 14:01:52,391 - __main__ - INFO - Initializing PO Automation System...
2025-08-22 14:01:52,391 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-22 14:01:52,392 - __main__ - INFO - PO Automation System initialized successfully
2025-08-22 14:01:52,991 - database.db_operations - INFO - Found 4 purchase orders
2025-08-22 14:01:53,134 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-22 14:01:53,134 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-22 14:01:53,166 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-22 14:01:53,174 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-22 14:01:55,497 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 14:01:55,505 - workflows.po_workflow - INFO - PO validation completed for PO-20250822140153
2025-08-22 14:01:55,507 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822140153
2025-08-22 14:02:17,901 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822140153
2025-08-22 14:02:17,903 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822140153
2025-08-22 14:02:32,442 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822140153
2025-08-22 14:02:53,232 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822140153
2025-08-22 14:02:58,871 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822140153
2025-08-22 14:03:06,022 - workflows.po_workflow - INFO - Notifications sent for PO-20250822140153
2025-08-22 14:03:06,024 - workflows.po_workflow - INFO - PO processing completed for PO-20250822140153 in 72.89s
2025-08-22 14:03:06,024 - __main__ - INFO - PO PO-20250822140153 processed in 72.89s - Decision: ERROR
2025-08-22 14:03:06,024 - __main__ - WARNING - PO PO-20250822140153 error: Payment plan error: PO 20250822140153 not found
2025-08-22 14:03:07,039 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-22 14:03:07,040 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-22 14:03:07,041 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-22 14:03:10,228 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 14:03:10,230 - workflows.po_workflow - INFO - PO validation completed for PO-20250822140307
2025-08-22 14:03:10,232 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822140307
2025-08-22 14:03:30,989 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822140307
2025-08-22 14:03:30,991 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822140307
2025-08-22 14:03:45,160 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822140307
2025-08-22 14:04:05,834 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822140307
2025-08-22 14:04:11,656 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822140307
2025-08-22 14:04:18,941 - workflows.po_workflow - INFO - Notifications sent for PO-20250822140307
2025-08-22 14:04:18,943 - workflows.po_workflow - INFO - PO processing completed for PO-20250822140307 in 71.90s
2025-08-22 14:04:18,944 - __main__ - INFO - PO PO-20250822140307 processed in 71.90s - Decision: ERROR
2025-08-22 14:04:18,944 - __main__ - WARNING - PO PO-20250822140307 error: Payment plan error: PO 20250822140307 not found
2025-08-22 14:04:19,962 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-22 14:04:19,962 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-22 14:04:19,964 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-22 14:04:21,988 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 14:04:21,990 - workflows.po_workflow - INFO - PO validation completed for PO-20250822140419
2025-08-22 14:04:21,991 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822140419
2025-08-22 14:04:42,695 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822140419
2025-08-22 14:04:42,697 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822140419
2025-08-22 14:05:03,661 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822140419
2025-08-22 14:05:18,023 - workflows.po_workflow - INFO - PO PO-20250822140419 auto-approved
2025-08-22 14:05:18,025 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822140419
2025-08-22 14:05:23,923 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822140419
2025-08-22 14:05:30,977 - workflows.po_workflow - INFO - Notifications sent for PO-20250822140419
2025-08-22 14:05:30,979 - workflows.po_workflow - INFO - PO processing completed for PO-20250822140419 in 71.02s
2025-08-22 14:05:30,979 - __main__ - INFO - PO PO-20250822140419 processed in 71.02s - Decision: ERROR
2025-08-22 14:05:30,979 - __main__ - WARNING - PO PO-20250822140419 error: Payment plan error: PO 20250822140419 not found
2025-08-22 14:05:31,994 - __main__ - INFO - Processing PO 4 for supplier SUP999
2025-08-22 14:05:31,994 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP999
2025-08-22 14:05:31,995 - workflows.po_workflow - INFO - Starting PO validation for request: SUP999
2025-08-22 14:05:33,896 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 14:05:33,898 - workflows.po_workflow - INFO - PO validation completed for PO-20250822140531
2025-08-22 14:05:33,900 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822140531
2025-08-22 14:05:55,743 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822140531
2025-08-22 14:06:10,556 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822140531
2025-08-22 14:06:33,311 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822140531
2025-08-22 14:06:40,581 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822140531
2025-08-22 14:06:48,655 - workflows.po_workflow - INFO - Notifications sent for PO-20250822140531
2025-08-22 14:06:48,659 - workflows.po_workflow - INFO - PO processing completed for PO-20250822140531 in 76.66s
2025-08-22 14:06:48,660 - __main__ - INFO - PO PO-20250822140531 processed in 76.66s - Decision: ERROR
2025-08-22 14:06:48,661 - __main__ - WARNING - PO PO-20250822140531 error: Payment plan error: PO 20250822140531 not found
2025-08-22 14:06:49,698 - database.db_operations - INFO - Database manager closed
2025-08-22 14:06:49,698 - __main__ - INFO - PO Automation System closed
2025-08-22 14:34:45,646 - __main__ - INFO - Initializing PO Automation System...
2025-08-22 14:34:45,647 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-22 14:34:45,647 - __main__ - INFO - PO Automation System initialized successfully
2025-08-22 14:34:46,396 - database.db_operations - INFO - Found 4 purchase orders
2025-08-22 14:34:46,530 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-22 14:34:46,530 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-22 14:34:46,563 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-22 14:34:46,570 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-22 14:34:48,838 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 14:34:48,847 - workflows.po_workflow - INFO - PO validation completed for PO-20250822143446
2025-08-22 14:34:48,849 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822143446
2025-08-22 14:35:10,635 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822143446
2025-08-22 14:35:10,637 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822143446
2025-08-22 14:35:24,617 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822143446
2025-08-22 14:35:46,166 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822143446
2025-08-22 14:35:52,624 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822143446
2025-08-22 14:35:59,774 - workflows.po_workflow - INFO - Notifications sent for PO-20250822143446
2025-08-22 14:35:59,777 - workflows.po_workflow - INFO - PO processing completed for PO-20250822143446 in 73.25s
2025-08-22 14:35:59,777 - __main__ - INFO - PO PO-20250822143446 processed in 73.25s - Decision: ERROR
2025-08-22 14:35:59,777 - __main__ - WARNING - PO PO-20250822143446 error: Payment plan error: PO 20250822143446 not found
2025-08-22 14:36:00,787 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-22 14:36:00,787 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-22 14:36:00,789 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-22 14:36:02,706 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 14:36:02,708 - workflows.po_workflow - INFO - PO validation completed for PO-20250822143600
2025-08-22 14:36:02,709 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822143600
2025-08-22 14:36:17,231 - database.db_operations - INFO - Database manager closed
2025-08-22 14:36:17,231 - __main__ - INFO - PO Automation System closed
2025-08-22 14:36:34,380 - __main__ - INFO - Initializing PO Automation System...
2025-08-22 14:36:34,380 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-22 14:36:34,381 - __main__ - INFO - PO Automation System initialized successfully
2025-08-22 14:36:35,343 - database.db_operations - INFO - Found 4 purchase orders
2025-08-22 14:36:35,569 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-22 14:36:35,569 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-22 14:36:35,653 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-22 14:36:35,670 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-22 14:36:38,059 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 14:36:38,089 - workflows.po_workflow - INFO - PO validation completed for PO-20250822143635
2025-08-22 14:36:38,093 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822143635
2025-08-22 14:37:00,089 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822143635
2025-08-22 14:37:00,091 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822143635
2025-08-22 14:37:14,493 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822143635
2025-08-22 14:37:36,204 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822143635
2025-08-22 14:37:42,323 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822143635
2025-08-22 14:37:49,624 - workflows.po_workflow - INFO - Notifications sent for PO-20250822143635
2025-08-22 14:37:49,626 - workflows.po_workflow - INFO - PO processing completed for PO-20250822143635 in 74.06s
2025-08-22 14:37:49,627 - __main__ - INFO - PO PO-20250822143635 processed in 74.06s - Decision: ERROR
2025-08-22 14:37:49,627 - __main__ - WARNING - PO PO-20250822143635 error: Payment plan error: PO 20250822143635 not found
2025-08-22 14:37:50,638 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-22 14:37:50,639 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-22 14:37:50,641 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-22 14:37:52,749 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 14:37:52,752 - workflows.po_workflow - INFO - PO validation completed for PO-20250822143750
2025-08-22 14:37:52,753 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822143750
2025-08-22 14:38:16,156 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822143750
2025-08-22 14:38:16,159 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822143750
2025-08-22 14:38:31,499 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822143750
2025-08-22 14:38:39,913 - workflows.po_workflow - ERROR - Error during approval processing: cannot access local variable 'call_tool_result' where it is not associated with a value
2025-08-22 14:38:39,916 - workflows.po_workflow - ERROR - Workflow execution failed: 'process_approval'
2025-08-22 14:38:39,917 - workflows.po_workflow - ERROR - Full traceback:
Traceback (most recent call last):
  File "C:\Python313\Lib\asyncio\runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Python313\Lib\asyncio\base_events.py", line 712, in run_until_complete
    self.run_forever()
    ~~~~~~~~~~~~~~~~^^
  File "C:\Python313\Lib\asyncio\base_events.py", line 683, in run_forever
    self._run_once()
    ~~~~~~~~~~~~~~^^
  File "C:\Python313\Lib\asyncio\base_events.py", line 2002, in _run_once
    event_list = self._selector.select(timeout)
  File "C:\Python313\Lib\asyncio\windows_events.py", line 446, in select
    self._poll(timeout)
    ~~~~~~~~~~^^^^^^^^^
  File "C:\Python313\Lib\asyncio\windows_events.py", line 775, in _poll
    status = _overlapped.GetQueuedCompletionStatus(self._iocp, ms)
  File "C:\Python313\Lib\asyncio\runners.py", line 157, in _on_sigint
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Demo Projects\PoAutomationAgent\workflows\po_workflow.py", line 1154, in process_po
    result = await self.workflow.ainvoke(initial_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 3112, in ainvoke
    async for chunk in self.astream(
    ...<29 lines>...
            chunks.append(chunk)
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 2939, in astream
    async for _ in runner.atick(
    ...<13 lines>...
            yield o
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_runner.py", line 295, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 712, in ainvoke
    input = await step.ainvoke(input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 192, in _aroute
    return self._finish(writer, input, result, config)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 205, in _finish
    r if isinstance(r, Send) else self.ends[r] for r in result
                                  ~~~~~~~~~^^^
KeyError: 'process_approval'
During task with name 'process_approval' and id '9734d7e9-7135-6780-dd17-6d0e35273b20'
2025-08-22 14:38:39,953 - __main__ - INFO - PO  processed in 49.31s - Decision: ERROR
2025-08-22 14:38:39,954 - __main__ - WARNING - PO  error: Workflow execution failed: 'process_approval'
2025-08-22 14:38:40,961 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-22 14:38:40,961 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-22 14:38:40,962 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-22 14:38:43,111 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 14:38:43,113 - workflows.po_workflow - INFO - PO validation completed for PO-20250822143840
2025-08-22 14:38:43,115 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822143840
2025-08-22 14:39:31,566 - __main__ - INFO - Initializing PO Automation System...
2025-08-22 14:39:31,567 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-22 14:39:31,567 - __main__ - INFO - PO Automation System initialized successfully
2025-08-22 14:39:33,444 - database.db_operations - INFO - Found 4 purchase orders
2025-08-22 14:39:33,664 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-22 14:39:33,664 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-22 14:39:33,695 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-22 14:39:33,704 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-22 14:39:36,675 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 14:39:36,686 - workflows.po_workflow - INFO - PO validation completed for PO-20250822143933
2025-08-22 14:39:36,688 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822143933
2025-08-22 14:39:59,150 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822143933
2025-08-22 14:39:59,152 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822143933
2025-08-22 14:40:13,843 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822143933
2025-08-22 14:40:35,574 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822143933
2025-08-22 14:40:42,985 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822143933
2025-08-22 14:40:50,513 - workflows.po_workflow - INFO - Notifications sent for PO-20250822143933
2025-08-22 14:40:50,518 - workflows.po_workflow - INFO - PO processing completed for PO-20250822143933 in 76.85s
2025-08-22 14:40:50,522 - __main__ - INFO - PO PO-20250822143933 processed in 76.85s - Decision: ERROR
2025-08-22 14:40:50,523 - __main__ - WARNING - PO PO-20250822143933 error: Payment plan error: PO 20250822143933 not found
2025-08-22 14:40:51,541 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-22 14:40:51,541 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-22 14:40:51,543 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-22 14:40:54,565 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 14:40:54,568 - workflows.po_workflow - INFO - PO validation completed for PO-20250822144051
2025-08-22 14:40:54,571 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822144051
2025-08-22 14:41:16,464 - workflows.po_workflow - ERROR - Error during supplier validation: unhandled errors in a TaskGroup (1 sub-exception)
2025-08-22 14:41:16,466 - workflows.po_workflow - ERROR - Workflow execution failed: 'check_supplier'
2025-08-22 14:41:16,466 - workflows.po_workflow - ERROR - Full traceback:
Traceback (most recent call last):
  File "C:\Demo Projects\PoAutomationAgent\workflows\po_workflow.py", line 1154, in process_po
    result = await self.workflow.ainvoke(initial_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 3112, in ainvoke
    async for chunk in self.astream(
    ...<29 lines>...
            chunks.append(chunk)
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 2939, in astream
    async for _ in runner.atick(
    ...<13 lines>...
            yield o
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_runner.py", line 295, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 712, in ainvoke
    input = await step.ainvoke(input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 192, in _aroute
    return self._finish(writer, input, result, config)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 205, in _finish
    r if isinstance(r, Send) else self.ends[r] for r in result
                                  ~~~~~~~~~^^^
KeyError: 'check_supplier'
During task with name 'check_supplier' and id 'aefbed6b-7bf8-23a7-2737-264401408780'
2025-08-22 14:41:16,479 - __main__ - INFO - PO  processed in 24.94s - Decision: ERROR
2025-08-22 14:41:16,479 - __main__ - WARNING - PO  error: Workflow execution failed: 'check_supplier'
2025-08-22 14:41:17,484 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-22 14:41:17,484 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-22 14:41:17,486 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-22 14:41:19,265 - database.db_operations - INFO - Database manager closed
2025-08-22 14:41:19,265 - __main__ - INFO - PO Automation System closed
2025-08-22 14:46:03,582 - __main__ - INFO - Initializing PO Automation System...
2025-08-22 14:46:03,582 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-22 14:46:03,582 - __main__ - INFO - PO Automation System initialized successfully
2025-08-22 14:46:05,178 - database.db_operations - INFO - Found 4 purchase orders
2025-08-22 14:46:05,324 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-22 14:46:05,324 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-22 14:46:05,354 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-22 14:46:05,362 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-22 14:46:07,754 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 14:46:07,762 - workflows.po_workflow - INFO - PO validation completed for PO-20250822144605
2025-08-22 14:46:07,764 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822144605
2025-08-22 14:46:30,721 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822144605
2025-08-22 14:46:30,723 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822144605
2025-08-22 14:46:45,019 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822144605
2025-08-22 14:47:07,217 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822144605
2025-08-22 14:47:13,298 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822144605
2025-08-22 14:47:20,678 - workflows.po_workflow - INFO - Notifications sent for PO-20250822144605
2025-08-22 14:47:20,679 - workflows.po_workflow - INFO - PO processing completed for PO-20250822144605 in 75.36s
2025-08-22 14:47:20,680 - __main__ - INFO - PO PO-20250822144605 processed in 75.36s - Decision: ERROR
2025-08-22 14:47:20,680 - __main__ - WARNING - PO PO-20250822144605 error: Payment plan error: PO 20250822144605 not found
2025-08-22 14:47:21,692 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-22 14:47:21,692 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-22 14:47:21,693 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-22 14:47:23,941 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 14:47:23,943 - workflows.po_workflow - INFO - PO validation completed for PO-20250822144721
2025-08-22 14:47:23,944 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822144721
2025-08-22 14:47:46,038 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822144721
2025-08-22 14:47:46,040 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822144721
2025-08-22 14:48:01,635 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822144721
2025-08-22 14:48:24,018 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822144721
2025-08-22 14:48:30,662 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822144721
2025-08-22 14:48:38,738 - workflows.po_workflow - INFO - Notifications sent for PO-20250822144721
2025-08-22 14:48:38,742 - workflows.po_workflow - INFO - PO processing completed for PO-20250822144721 in 77.05s
2025-08-22 14:48:38,743 - __main__ - INFO - PO PO-20250822144721 processed in 77.05s - Decision: ERROR
2025-08-22 14:48:38,743 - __main__ - WARNING - PO PO-20250822144721 error: Payment plan error: PO 20250822144721 not found
2025-08-22 14:48:39,796 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-22 14:48:39,798 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-22 14:48:39,800 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-22 14:48:41,530 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 14:48:41,534 - workflows.po_workflow - INFO - PO validation completed for PO-20250822144839
2025-08-22 14:48:41,537 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822144839
2025-08-22 14:49:05,648 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822144839
2025-08-22 14:49:05,651 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822144839
2025-08-22 14:49:28,109 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822144839
2025-08-22 14:49:42,887 - workflows.po_workflow - INFO - PO PO-20250822144839 auto-approved
2025-08-22 14:49:42,890 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822144839
2025-08-22 14:49:48,950 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822144839
2025-08-22 14:49:56,359 - workflows.po_workflow - INFO - Notifications sent for PO-20250822144839
2025-08-22 14:49:56,362 - workflows.po_workflow - INFO - PO processing completed for PO-20250822144839 in 76.56s
2025-08-22 14:49:56,362 - __main__ - INFO - PO PO-20250822144839 processed in 76.56s - Decision: ERROR
2025-08-22 14:49:56,363 - __main__ - WARNING - PO PO-20250822144839 error: Payment plan error: PO 20250822144839 not found
2025-08-22 14:49:57,387 - __main__ - INFO - Processing PO 4 for supplier SUP999
2025-08-22 14:49:57,388 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP999
2025-08-22 14:49:57,390 - workflows.po_workflow - INFO - Starting PO validation for request: SUP999
2025-08-22 14:49:59,362 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 14:49:59,365 - workflows.po_workflow - INFO - PO validation completed for PO-20250822144957
2025-08-22 14:49:59,367 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822144957
2025-08-22 14:50:21,606 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822144957
2025-08-22 14:50:36,238 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822144957
2025-08-22 14:50:59,106 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822144957
2025-08-22 14:51:06,010 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822144957
2025-08-22 14:51:14,030 - workflows.po_workflow - INFO - Notifications sent for PO-20250822144957
2025-08-22 14:51:14,033 - workflows.po_workflow - INFO - PO processing completed for PO-20250822144957 in 76.65s
2025-08-22 14:51:14,033 - __main__ - INFO - PO PO-20250822144957 processed in 76.65s - Decision: ERROR
2025-08-22 14:51:14,034 - __main__ - WARNING - PO PO-20250822144957 error: Payment plan error: PO 20250822144957 not found
2025-08-22 14:51:15,051 - database.db_operations - INFO - Database manager closed
2025-08-22 14:51:15,051 - __main__ - INFO - PO Automation System closed
2025-08-22 15:02:25,569 - __main__ - INFO - Initializing PO Automation System...
2025-08-22 15:02:25,570 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-22 15:02:25,570 - __main__ - INFO - PO Automation System initialized successfully
2025-08-22 15:02:26,179 - database.db_operations - INFO - Found 4 purchase orders
2025-08-22 15:02:26,337 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-22 15:02:26,338 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-22 15:02:26,374 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-22 15:02:26,384 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-22 15:02:28,859 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 15:02:28,873 - workflows.po_workflow - INFO - PO validation completed for PO-20250822150226
2025-08-22 15:02:28,876 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822150226
2025-08-22 15:02:58,805 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822150226
2025-08-22 15:02:58,807 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822150226
2025-08-22 15:03:16,793 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822150226
2025-08-22 15:03:42,907 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822150226
2025-08-22 15:03:50,741 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822150226
2025-08-22 15:03:59,350 - workflows.po_workflow - INFO - Notifications sent for PO-20250822150226
2025-08-22 15:03:59,353 - workflows.po_workflow - INFO - PO processing completed for PO-20250822150226 in 93.02s
2025-08-22 15:03:59,354 - __main__ - INFO - PO PO-20250822150226 processed in 93.02s - Decision: ERROR
2025-08-22 15:03:59,354 - __main__ - WARNING - PO PO-20250822150226 error: Payment plan error: recommend_payment_plan failed: (207, b"Invalid column name 'curr'.DB-Lib error message 20018, severity 16:\nGeneral SQL Server error: Check messages from the SQL Server\n")
2025-08-22 15:04:00,371 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-22 15:04:00,371 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-22 15:04:00,373 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-22 15:04:16,273 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 15:04:16,275 - workflows.po_workflow - INFO - PO validation completed for PO-20250822150400
2025-08-22 15:04:16,277 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822150400
2025-08-22 15:04:41,590 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822150400
2025-08-22 15:04:41,594 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822150400
2025-08-22 15:04:57,049 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822150400
2025-08-22 15:05:16,202 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822150400
2025-08-22 15:05:24,689 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822150400
2025-08-22 15:05:31,565 - workflows.po_workflow - INFO - Notifications sent for PO-20250822150400
2025-08-22 15:05:31,566 - workflows.po_workflow - INFO - PO processing completed for PO-20250822150400 in 91.20s
2025-08-22 15:05:31,567 - __main__ - INFO - PO PO-20250822150400 processed in 91.20s - Decision: ERROR
2025-08-22 15:05:31,567 - __main__ - WARNING - PO PO-20250822150400 error: Payment plan error: recommend_payment_plan failed: (207, b"Invalid column name 'curr'.DB-Lib error message 20018, severity 16:\nGeneral SQL Server error: Check messages from the SQL Server\n")
2025-08-22 15:05:32,581 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-22 15:05:32,582 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-22 15:05:32,582 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-22 15:05:34,390 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 15:05:34,391 - workflows.po_workflow - INFO - PO validation completed for PO-20250822150532
2025-08-22 15:05:34,392 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822150532
2025-08-22 15:05:53,319 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822150532
2025-08-22 15:05:53,321 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822150532
2025-08-22 15:06:02,455 - database.db_operations - INFO - Database manager closed
2025-08-22 15:06:02,456 - __main__ - INFO - PO Automation System closed
2025-08-22 15:09:41,447 - __main__ - INFO - Initializing PO Automation System...
2025-08-22 15:09:41,447 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-22 15:09:41,447 - __main__ - INFO - PO Automation System initialized successfully
2025-08-22 15:09:41,980 - database.db_operations - INFO - Found 4 purchase orders
2025-08-22 15:09:42,123 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-22 15:09:42,123 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-22 15:09:42,153 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-22 15:09:42,161 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-22 15:09:44,632 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 15:09:44,638 - workflows.po_workflow - INFO - PO validation completed for PO-20250822150942
2025-08-22 15:09:44,639 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822150942
2025-08-22 15:10:03,121 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822150942
2025-08-22 15:10:03,123 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822150942
2025-08-22 15:10:15,285 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822150942
2025-08-22 15:10:33,518 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822150942
2025-08-22 15:10:35,739 - workflows.po_workflow - ERROR - Error getting tools from payment: unhandled errors in a TaskGroup (1 sub-exception)
2025-08-22 15:10:35,740 - workflows.po_workflow - ERROR - Error during payment calculation: Payment tool 'recommend_payment_plan' not found. Available: []
2025-08-22 15:10:35,741 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822150942
2025-08-22 15:10:42,469 - workflows.po_workflow - INFO - Notifications sent for PO-20250822150942
2025-08-22 15:10:42,471 - workflows.po_workflow - INFO - PO processing completed for PO-20250822150942 in 60.35s
2025-08-22 15:10:42,471 - __main__ - INFO - PO PO-20250822150942 processed in 60.35s - Decision: ERROR
2025-08-22 15:10:42,471 - __main__ - WARNING - PO PO-20250822150942 error: Error during payment calculation: Payment tool 'recommend_payment_plan' not found. Available: []
2025-08-22 15:10:43,483 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-22 15:10:43,483 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-22 15:10:43,484 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-22 15:10:45,302 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 15:10:45,304 - workflows.po_workflow - INFO - PO validation completed for PO-20250822151043
2025-08-22 15:10:45,305 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822151043
2025-08-22 15:11:04,339 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822151043
2025-08-22 15:11:04,341 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822151043
2025-08-22 15:11:17,100 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822151043
2025-08-22 15:11:36,192 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822151043
2025-08-22 15:11:42,304 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822151043
2025-08-22 15:11:49,257 - workflows.po_workflow - INFO - Notifications sent for PO-20250822151043
2025-08-22 15:11:49,259 - workflows.po_workflow - INFO - PO processing completed for PO-20250822151043 in 65.78s
2025-08-22 15:11:49,259 - __main__ - INFO - PO PO-20250822151043 processed in 65.78s - Decision: ERROR
2025-08-22 15:11:49,260 - __main__ - WARNING - PO PO-20250822151043 error: Payment plan error: recommend_payment_plan failed: (207, b"Invalid column name 'curr'.DB-Lib error message 20018, severity 16:\nGeneral SQL Server error: Check messages from the SQL Server\n")
2025-08-22 15:11:50,268 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-22 15:11:50,269 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-22 15:11:50,271 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-22 15:11:51,986 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 15:11:51,989 - workflows.po_workflow - INFO - PO validation completed for PO-20250822151150
2025-08-22 15:11:51,991 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822151150
2025-08-22 15:12:11,599 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822151150
2025-08-22 15:12:11,602 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822151150
2025-08-22 15:12:31,546 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822151150
2025-08-22 15:12:44,656 - workflows.po_workflow - INFO - PO PO-20250822151150 auto-approved
2025-08-22 15:12:44,657 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822151150
2025-08-22 15:12:50,741 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822151150
2025-08-22 15:12:57,822 - workflows.po_workflow - INFO - Notifications sent for PO-20250822151150
2025-08-22 15:12:57,824 - workflows.po_workflow - INFO - PO processing completed for PO-20250822151150 in 67.56s
2025-08-22 15:12:57,824 - __main__ - INFO - PO PO-20250822151150 processed in 67.56s - Decision: ERROR
2025-08-22 15:12:57,824 - __main__ - WARNING - PO PO-20250822151150 error: Payment plan error: recommend_payment_plan failed: (207, b"Invalid column name 'curr'.DB-Lib error message 20018, severity 16:\nGeneral SQL Server error: Check messages from the SQL Server\n")
2025-08-22 15:12:58,831 - __main__ - INFO - Processing PO 4 for supplier SUP999
2025-08-22 15:12:58,832 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP999
2025-08-22 15:12:58,834 - workflows.po_workflow - INFO - Starting PO validation for request: SUP999
2025-08-22 15:13:00,917 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 15:13:00,919 - workflows.po_workflow - INFO - PO validation completed for PO-20250822151258
2025-08-22 15:13:00,920 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822151258
2025-08-22 15:13:21,132 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822151258
2025-08-22 15:13:34,287 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822151258
2025-08-22 15:13:53,691 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822151258
2025-08-22 15:13:59,611 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822151258
2025-08-22 15:14:06,428 - workflows.po_workflow - INFO - Notifications sent for PO-20250822151258
2025-08-22 15:14:06,429 - workflows.po_workflow - INFO - PO processing completed for PO-20250822151258 in 67.60s
2025-08-22 15:14:06,430 - __main__ - INFO - PO PO-20250822151258 processed in 67.60s - Decision: ERROR
2025-08-22 15:14:06,430 - __main__ - WARNING - PO PO-20250822151258 error: Payment plan error: recommend_payment_plan failed: (207, b"Invalid column name 'curr'.DB-Lib error message 20018, severity 16:\nGeneral SQL Server error: Check messages from the SQL Server\n")
2025-08-22 15:14:07,440 - database.db_operations - INFO - Database manager closed
2025-08-22 15:14:07,440 - __main__ - INFO - PO Automation System closed
2025-08-22 15:17:54,646 - __main__ - INFO - Initializing PO Automation System...
2025-08-22 15:17:54,646 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-22 15:17:54,647 - __main__ - INFO - PO Automation System initialized successfully
2025-08-22 15:17:55,203 - database.db_operations - INFO - Found 4 purchase orders
2025-08-22 15:17:55,343 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-22 15:17:55,343 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-22 15:17:55,369 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-22 15:17:55,375 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-22 15:17:57,980 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 15:17:57,987 - workflows.po_workflow - INFO - PO validation completed for PO-20250822151755
2025-08-22 15:17:57,988 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822151755
2025-08-22 15:18:16,404 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822151755
2025-08-22 15:18:16,406 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822151755
2025-08-22 15:18:28,843 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822151755
2025-08-22 15:18:47,351 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822151755
2025-08-22 15:18:52,864 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822151755
2025-08-22 15:18:59,364 - workflows.po_workflow - INFO - Notifications sent for PO-20250822151755
2025-08-22 15:18:59,366 - workflows.po_workflow - INFO - PO processing completed for PO-20250822151755 in 64.02s
2025-08-22 15:18:59,366 - __main__ - INFO - PO PO-20250822151755 processed in 64.02s - Decision: ERROR
2025-08-22 15:18:59,366 - __main__ - WARNING - PO PO-20250822151755 error: Payment plan error: PO 20250822151755 not found
2025-08-22 15:19:00,379 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-22 15:19:00,380 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-22 15:19:00,383 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-22 15:19:02,853 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 15:19:02,857 - workflows.po_workflow - INFO - PO validation completed for PO-20250822151900
2025-08-22 15:19:02,858 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822151900
2025-08-22 15:19:22,381 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822151900
2025-08-22 15:19:22,382 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822151900
2025-08-22 15:19:34,837 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822151900
2025-08-22 15:19:53,784 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822151900
2025-08-22 15:19:59,809 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822151900
2025-08-22 15:20:06,951 - workflows.po_workflow - INFO - Notifications sent for PO-20250822151900
2025-08-22 15:20:06,954 - workflows.po_workflow - INFO - PO processing completed for PO-20250822151900 in 66.57s
2025-08-22 15:20:06,954 - __main__ - INFO - PO PO-20250822151900 processed in 66.57s - Decision: ERROR
2025-08-22 15:20:06,955 - __main__ - WARNING - PO PO-20250822151900 error: Payment plan error: PO 20250822151900 not found
2025-08-22 15:20:07,973 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-22 15:20:07,973 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-22 15:20:07,975 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-22 15:20:09,876 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 15:20:09,878 - workflows.po_workflow - INFO - PO validation completed for PO-20250822152007
2025-08-22 15:20:09,879 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822152007
2025-08-22 15:20:28,663 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822152007
2025-08-22 15:20:28,665 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822152007
2025-08-22 15:20:47,991 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822152007
2025-08-22 15:21:00,098 - workflows.po_workflow - INFO - PO PO-20250822152007 auto-approved
2025-08-22 15:21:00,101 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822152007
2025-08-22 15:21:06,304 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822152007
2025-08-22 15:21:12,843 - workflows.po_workflow - INFO - Notifications sent for PO-20250822152007
2025-08-22 15:21:12,845 - workflows.po_workflow - INFO - PO processing completed for PO-20250822152007 in 64.87s
2025-08-22 15:21:12,846 - __main__ - INFO - PO PO-20250822152007 processed in 64.87s - Decision: ERROR
2025-08-22 15:21:12,846 - __main__ - WARNING - PO PO-20250822152007 error: Payment plan error: PO 20250822152007 not found
2025-08-22 15:21:13,852 - __main__ - INFO - Processing PO 4 for supplier SUP999
2025-08-22 15:21:13,853 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP999
2025-08-22 15:21:13,854 - workflows.po_workflow - INFO - Starting PO validation for request: SUP999
2025-08-22 15:21:15,807 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 15:21:15,810 - workflows.po_workflow - INFO - PO validation completed for PO-20250822152113
2025-08-22 15:21:15,812 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822152113
2025-08-22 15:21:35,042 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822152113
2025-08-22 15:21:47,935 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822152113
2025-08-22 15:22:07,801 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822152113
2025-08-22 15:22:13,333 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822152113
2025-08-22 15:22:20,204 - workflows.po_workflow - INFO - Notifications sent for PO-20250822152113
2025-08-22 15:22:20,206 - workflows.po_workflow - INFO - PO processing completed for PO-20250822152113 in 66.35s
2025-08-22 15:22:20,206 - __main__ - INFO - PO PO-20250822152113 processed in 66.35s - Decision: ERROR
2025-08-22 15:22:20,206 - __main__ - WARNING - PO PO-20250822152113 error: Payment plan error: PO 20250822152113 not found
2025-08-22 15:22:21,216 - database.db_operations - INFO - Database manager closed
2025-08-22 15:22:21,216 - __main__ - INFO - PO Automation System closed
2025-08-22 15:35:46,182 - __main__ - INFO - Initializing PO Automation System...
2025-08-22 15:35:46,183 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-22 15:35:46,184 - __main__ - INFO - PO Automation System initialized successfully
2025-08-22 15:35:48,082 - database.db_operations - INFO - Found 4 purchase orders
2025-08-22 15:35:48,356 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-22 15:35:48,356 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-22 15:35:48,385 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-22 15:35:48,401 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-22 15:35:50,875 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 15:35:50,881 - workflows.po_workflow - INFO - PO validation completed for PO-20250822153548
2025-08-22 15:35:50,883 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822153548
2025-08-22 15:36:10,167 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822153548
2025-08-22 15:36:10,168 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822153548
2025-08-22 15:36:22,591 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822153548
2025-08-22 15:36:41,199 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822153548
2025-08-22 15:36:45,470 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822153548
2025-08-22 15:36:51,952 - workflows.po_workflow - INFO - Notifications sent for PO-20250822153548
2025-08-22 15:36:51,953 - workflows.po_workflow - INFO - PO processing completed for PO-20250822153548 in 63.60s
2025-08-22 15:36:51,953 - __main__ - INFO - PO PO-20250822153548 processed in 63.60s - Decision: ERROR
2025-08-22 15:36:51,954 - __main__ - WARNING - PO PO-20250822153548 error: Payment plan error: '20250822153548' looks like a request code, not a DB po_id. Pass the integer PurchaseOrders.po_id (e.g., 1, 2, 3). Alternatively, use 'recommend_payment_plan_by_supplier' with supplier_id.
2025-08-22 15:36:52,965 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-22 15:36:52,965 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-22 15:36:52,967 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-22 15:36:55,379 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 15:36:55,381 - workflows.po_workflow - INFO - PO validation completed for PO-20250822153652
2025-08-22 15:36:55,382 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822153652
2025-08-22 15:37:13,544 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822153652
2025-08-22 15:37:13,545 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822153652
2025-08-22 15:37:19,448 - workflows.po_workflow - ERROR - Error getting tools from budget: unhandled errors in a TaskGroup (1 sub-exception)
2025-08-22 15:37:19,448 - workflows.po_workflow - ERROR - Error during budget verification: Budget check tool not found. Available: []
2025-08-22 15:37:19,450 - workflows.po_workflow - ERROR - Workflow execution failed: 'verify_budget'
2025-08-22 15:37:19,450 - workflows.po_workflow - ERROR - Full traceback:
Traceback (most recent call last):
  File "C:\Demo Projects\PoAutomationAgent\workflows\po_workflow.py", line 1154, in process_po
    result = await self.workflow.ainvoke(initial_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 3112, in ainvoke
    async for chunk in self.astream(
    ...<29 lines>...
            chunks.append(chunk)
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 2939, in astream
    async for _ in runner.atick(
    ...<13 lines>...
            yield o
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_runner.py", line 295, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 712, in ainvoke
    input = await step.ainvoke(input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 192, in _aroute
    return self._finish(writer, input, result, config)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 205, in _finish
    r if isinstance(r, Send) else self.ends[r] for r in result
                                  ~~~~~~~~~^^^
KeyError: 'verify_budget'
During task with name 'verify_budget' and id 'ec8fddb3-1278-09b1-e79b-f2e8ac593558'
2025-08-22 15:37:19,493 - __main__ - INFO - PO  processed in 26.53s - Decision: ERROR
2025-08-22 15:37:19,493 - __main__ - WARNING - PO  error: Workflow execution failed: 'verify_budget'
2025-08-22 15:37:20,500 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-22 15:37:20,501 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-22 15:37:20,502 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-22 15:37:22,379 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 15:37:22,380 - workflows.po_workflow - INFO - PO validation completed for PO-20250822153720
2025-08-22 15:37:22,382 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822153720
2025-08-22 15:37:28,881 - workflows.po_workflow - ERROR - Error during supplier validation: cannot access local variable 'call_tool_result' where it is not associated with a value
2025-08-22 15:37:28,883 - workflows.po_workflow - ERROR - Workflow execution failed: 'check_supplier'
2025-08-22 15:37:28,883 - workflows.po_workflow - ERROR - Full traceback:
Traceback (most recent call last):
  File "C:\Python313\Lib\asyncio\runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Python313\Lib\asyncio\base_events.py", line 712, in run_until_complete
    self.run_forever()
    ~~~~~~~~~~~~~~~~^^
  File "C:\Python313\Lib\asyncio\base_events.py", line 683, in run_forever
    self._run_once()
    ~~~~~~~~~~~~~~^^
  File "C:\Python313\Lib\asyncio\base_events.py", line 2002, in _run_once
    event_list = self._selector.select(timeout)
  File "C:\Python313\Lib\asyncio\windows_events.py", line 446, in select
    self._poll(timeout)
    ~~~~~~~~~~^^^^^^^^^
  File "C:\Python313\Lib\asyncio\windows_events.py", line 775, in _poll
    status = _overlapped.GetQueuedCompletionStatus(self._iocp, ms)
  File "C:\Python313\Lib\asyncio\runners.py", line 157, in _on_sigint
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Demo Projects\PoAutomationAgent\workflows\po_workflow.py", line 1154, in process_po
    result = await self.workflow.ainvoke(initial_state)
             ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 3112, in ainvoke
    async for chunk in self.astream(
    ...<29 lines>...
            chunks.append(chunk)
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\main.py", line 2939, in astream
    async for _ in runner.atick(
    ...<13 lines>...
            yield o
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_runner.py", line 295, in atick
    await arun_with_retry(
    ...<15 lines>...
    )
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\pregel\_retry.py", line 137, in arun_with_retry
    return await task.proc.ainvoke(task.input, config)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 712, in ainvoke
    input = await step.ainvoke(input, config)
            ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\_internal\_runnable.py", line 474, in ainvoke
    ret = await self.afunc(*args, **kwargs)
          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 192, in _aroute
    return self._finish(writer, input, result, config)
           ~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langgraph\graph\_branch.py", line 205, in _finish
    r if isinstance(r, Send) else self.ends[r] for r in result
                                  ~~~~~~~~~^^^
KeyError: 'check_supplier'
During task with name 'check_supplier' and id '064852e6-6ae9-392d-9a68-eab5832c1364'
2025-08-22 15:37:28,893 - __main__ - INFO - PO  processed in 8.39s - Decision: ERROR
2025-08-22 15:37:28,893 - __main__ - WARNING - PO  error: Workflow execution failed: 'check_supplier'
2025-08-22 15:37:29,905 - __main__ - INFO - Processing PO 4 for supplier SUP999
2025-08-22 15:37:29,906 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP999
2025-08-22 15:37:29,906 - workflows.po_workflow - INFO - Starting PO validation for request: SUP999
2025-08-22 15:37:31,594 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 15:37:31,596 - workflows.po_workflow - INFO - PO validation completed for PO-20250822153729
2025-08-22 15:37:31,598 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822153729
2025-08-22 15:37:50,683 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822153729
2025-08-22 15:38:03,250 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822153729
2025-08-22 15:38:22,262 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822153729
2025-08-22 15:38:26,695 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822153729
2025-08-22 15:38:33,173 - workflows.po_workflow - INFO - Notifications sent for PO-20250822153729
2025-08-22 15:38:33,174 - workflows.po_workflow - INFO - PO processing completed for PO-20250822153729 in 63.27s
2025-08-22 15:38:33,175 - __main__ - INFO - PO PO-20250822153729 processed in 63.27s - Decision: ERROR
2025-08-22 15:38:33,175 - __main__ - WARNING - PO PO-20250822153729 error: Payment plan error: '20250822153729' looks like a request code, not a DB po_id. Pass the integer PurchaseOrders.po_id (e.g., 1, 2, 3). Alternatively, use 'recommend_payment_plan_by_supplier' with supplier_id.
2025-08-22 15:38:34,181 - database.db_operations - INFO - Database manager closed
2025-08-22 15:38:34,182 - __main__ - INFO - PO Automation System closed
2025-08-22 15:38:34,183 - asyncio - ERROR - unhandled exception during asyncio.run() shutdown
task: <Task finished name='Task-85' coro=<StructuredTool._arun() done, defined at C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langchain_core\tools\structured.py:97> exception=UnboundLocalError("cannot access local variable 'call_tool_result' where it is not associated with a value")>
Traceback (most recent call last):
  File "C:\Python313\Lib\asyncio\runners.py", line 195, in run
    return runner.run(main)
           ~~~~~~~~~~^^^^^^
  File "C:\Python313\Lib\asyncio\runners.py", line 118, in run
    return self._loop.run_until_complete(task)
           ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~^^^^^^
  File "C:\Python313\Lib\asyncio\base_events.py", line 712, in run_until_complete
    self.run_forever()
    ~~~~~~~~~~~~~~~~^^
  File "C:\Python313\Lib\asyncio\base_events.py", line 683, in run_forever
    self._run_once()
    ~~~~~~~~~~~~~~^^
  File "C:\Python313\Lib\asyncio\base_events.py", line 2002, in _run_once
    event_list = self._selector.select(timeout)
  File "C:\Python313\Lib\asyncio\windows_events.py", line 446, in select
    self._poll(timeout)
    ~~~~~~~~~~^^^^^^^^^
  File "C:\Python313\Lib\asyncio\windows_events.py", line 775, in _poll
    status = _overlapped.GetQueuedCompletionStatus(self._iocp, ms)
  File "C:\Python313\Lib\asyncio\runners.py", line 157, in _on_sigint
    raise KeyboardInterrupt()
KeyboardInterrupt

During handling of the above exception, another exception occurred:

Traceback (most recent call last):
  File "C:\Demo Projects\PoAutomationAgent\workflows\po_workflow.py", line 849, in check_supplier
    raw_supplier_result = await validate_tool.ainvoke({"supplier_id": supplier_id})
                          ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langchain_core\tools\structured.py", line 66, in ainvoke
    return await super().ainvoke(input, config, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langchain_core\tools\base.py", line 614, in ainvoke
    return await self.arun(tool_input, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langchain_core\tools\base.py", line 1001, in arun
    raise error_to_raise
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langchain_core\tools\base.py", line 970, in arun
    response = await coro_with_context(coro, context)
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langchain_core\tools\structured.py", line 110, in _arun
    return await self.coroutine(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Demo Projects\PoAutomationAgent\venv\Lib\site-packages\langchain_mcp_adapters\tools.py", line 132, in call_tool
    return _convert_call_tool_result(call_tool_result)
                                     ^^^^^^^^^^^^^^^^
UnboundLocalError: cannot access local variable 'call_tool_result' where it is not associated with a value
2025-08-22 15:49:35,379 - __main__ - INFO - Initializing PO Automation System...
2025-08-22 15:49:35,380 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-22 15:49:35,381 - __main__ - INFO - PO Automation System initialized successfully
2025-08-22 15:49:36,010 - database.db_operations - INFO - Found 4 purchase orders
2025-08-22 15:49:36,148 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-22 15:49:36,149 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-22 15:49:36,168 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-22 15:49:36,177 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-22 15:49:38,536 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 15:49:38,544 - workflows.po_workflow - INFO - PO validation completed for PO-20250822154936
2025-08-22 15:49:38,545 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822154936
2025-08-22 15:49:57,157 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822154936
2025-08-22 15:49:57,159 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822154936
2025-08-22 15:50:09,170 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822154936
2025-08-22 15:50:27,586 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822154936
2025-08-22 15:50:32,492 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822154936
2025-08-22 15:50:39,140 - workflows.po_workflow - INFO - Notifications sent for PO-20250822154936
2025-08-22 15:50:39,141 - workflows.po_workflow - INFO - PO processing completed for PO-20250822154936 in 62.99s
2025-08-22 15:50:39,141 - __main__ - INFO - PO PO-20250822154936 processed in 62.99s - Decision: ERROR
2025-08-22 15:50:39,142 - __main__ - WARNING - PO PO-20250822154936 error: Payment plan error: PO 20250822154936 not found in PurchaseOrders.po_id
2025-08-22 15:50:40,145 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-22 15:50:40,145 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-22 15:50:40,147 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-22 15:50:42,256 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 15:50:42,257 - workflows.po_workflow - INFO - PO validation completed for PO-20250822155040
2025-08-22 15:50:42,258 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822155040
2025-08-22 15:50:58,530 - database.db_operations - INFO - Database manager closed
2025-08-22 15:50:58,531 - __main__ - INFO - PO Automation System closed
2025-08-22 16:00:57,748 - __main__ - INFO - Initializing PO Automation System...
2025-08-22 16:00:57,748 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-22 16:00:57,748 - __main__ - INFO - PO Automation System initialized successfully
2025-08-22 16:00:58,347 - database.db_operations - INFO - Found 4 purchase orders
2025-08-22 16:00:58,532 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-22 16:00:58,532 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-22 16:00:58,554 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-22 16:00:58,561 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-22 16:01:00,508 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 16:01:00,513 - workflows.po_workflow - INFO - PO validation completed for PO-20250822160058
2025-08-22 16:01:00,515 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822160058
2025-08-22 16:01:18,805 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822160058
2025-08-22 16:01:18,807 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822160058
2025-08-22 16:01:31,085 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822160058
2025-08-22 16:01:50,037 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822160058
2025-08-22 16:01:58,808 - workflows.po_workflow - INFO - Payment plan computed for PO PO-20250822160058
2025-08-22 16:01:58,810 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822160058
2025-08-22 16:02:05,356 - workflows.po_workflow - INFO - Notifications sent for PO-20250822160058
2025-08-22 16:02:05,358 - workflows.po_workflow - INFO - PO processing completed for PO-20250822160058 in 66.83s
2025-08-22 16:02:05,358 - __main__ - INFO - PO PO-20250822160058 processed in 66.83s - Decision: PENDING_APPROVAL
2025-08-22 16:02:06,364 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-22 16:02:06,364 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-22 16:02:06,367 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-22 16:02:08,134 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 16:02:08,136 - workflows.po_workflow - INFO - PO validation completed for PO-20250822160206
2025-08-22 16:02:08,138 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822160206
2025-08-22 16:02:26,856 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822160206
2025-08-22 16:02:26,858 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822160206
2025-08-22 16:02:39,539 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822160206
2025-08-22 16:02:58,665 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822160206
2025-08-22 16:03:07,392 - workflows.po_workflow - INFO - Payment plan computed for PO PO-20250822160206
2025-08-22 16:03:07,393 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822160206
2025-08-22 16:03:14,302 - workflows.po_workflow - INFO - Notifications sent for PO-20250822160206
2025-08-22 16:03:14,304 - workflows.po_workflow - INFO - PO processing completed for PO-20250822160206 in 67.94s
2025-08-22 16:03:14,305 - __main__ - INFO - PO PO-20250822160206 processed in 67.94s - Decision: PENDING_APPROVAL
2025-08-22 16:03:15,309 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-22 16:03:15,309 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-22 16:03:15,310 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-22 16:03:16,970 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 16:03:16,972 - workflows.po_workflow - INFO - PO validation completed for PO-20250822160315
2025-08-22 16:03:16,975 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822160315
2025-08-22 16:03:36,613 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822160315
2025-08-22 16:03:36,615 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822160315
2025-08-22 16:03:55,379 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822160315
2025-08-22 16:04:07,799 - workflows.po_workflow - INFO - PO PO-20250822160315 auto-approved
2025-08-22 16:04:07,800 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822160315
2025-08-22 16:04:16,339 - workflows.po_workflow - INFO - Payment plan computed for PO PO-20250822160315
2025-08-22 16:04:16,341 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822160315
2025-08-22 16:04:23,102 - workflows.po_workflow - INFO - Notifications sent for PO-20250822160315
2025-08-22 16:04:23,103 - workflows.po_workflow - INFO - PO processing completed for PO-20250822160315 in 67.79s
2025-08-22 16:04:23,104 - __main__ - INFO - PO PO-20250822160315 processed in 67.79s - Decision: APPROVED
2025-08-22 16:04:24,115 - __main__ - INFO - Processing PO 4 for supplier SUP999
2025-08-22 16:04:24,115 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP999
2025-08-22 16:04:24,116 - workflows.po_workflow - INFO - Starting PO validation for request: SUP999
2025-08-22 16:04:25,964 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 16:04:25,967 - workflows.po_workflow - INFO - PO validation completed for PO-20250822160424
2025-08-22 16:04:25,968 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822160424
2025-08-22 16:04:44,714 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822160424
2025-08-22 16:04:56,861 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822160424
2025-08-22 16:05:15,421 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822160424
2025-08-22 16:05:24,351 - workflows.po_workflow - INFO - Payment plan computed for PO PO-20250822160424
2025-08-22 16:05:24,352 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822160424
2025-08-22 16:05:31,237 - workflows.po_workflow - INFO - Notifications sent for PO-20250822160424
2025-08-22 16:05:31,239 - workflows.po_workflow - INFO - PO processing completed for PO-20250822160424 in 67.12s
2025-08-22 16:05:31,239 - __main__ - INFO - PO PO-20250822160424 processed in 67.12s - Decision: PENDING_APPROVAL
2025-08-22 16:05:32,254 - database.db_operations - INFO - Database manager closed
2025-08-22 16:05:32,255 - __main__ - INFO - PO Automation System closed
2025-08-22 16:58:30,096 - __main__ - INFO - Initializing PO Automation System...
2025-08-22 16:58:30,097 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-22 16:58:30,097 - __main__ - INFO - PO Automation System initialized successfully
2025-08-22 16:58:30,652 - database.db_operations - INFO - Found 4 purchase orders
2025-08-22 16:58:30,788 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-22 16:58:30,789 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-22 16:58:30,814 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-22 16:58:30,823 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-22 16:58:32,862 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 16:58:32,873 - workflows.po_workflow - INFO - PO validation completed for PO-20250822165830
2025-08-22 16:58:32,875 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822165830
2025-08-22 16:58:51,311 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822165830
2025-08-22 16:58:51,312 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822165830
2025-08-22 16:59:03,303 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822165830
2025-08-22 16:59:20,923 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822165830
2025-08-22 16:59:34,425 - workflows.po_workflow - INFO - Payment plan computed for PO PO-20250822165830
2025-08-22 16:59:34,426 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822165830
2025-08-22 16:59:41,098 - workflows.po_workflow - INFO - Notifications sent for PO-20250822165830
2025-08-22 16:59:41,099 - workflows.po_workflow - INFO - PO processing completed for PO-20250822165830 in 70.31s
2025-08-22 16:59:41,099 - __main__ - INFO - PO PO-20250822165830 processed in 70.31s - Decision: PENDING_APPROVAL
2025-08-22 16:59:41,100 - __main__ - INFO - PaymentPlan | PO PO-20250822165830 | skipped (decision=PENDING_APPROVAL)
2025-08-22 16:59:42,105 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-22 16:59:42,105 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-22 16:59:42,107 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-22 16:59:44,016 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 16:59:44,017 - workflows.po_workflow - INFO - PO validation completed for PO-20250822165942
2025-08-22 16:59:44,019 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822165942
2025-08-22 17:00:03,145 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822165942
2025-08-22 17:00:03,146 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822165942
2025-08-22 17:00:15,361 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822165942
2025-08-22 17:00:34,241 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822165942
2025-08-22 17:00:42,502 - workflows.po_workflow - INFO - Payment plan computed for PO PO-20250822165942
2025-08-22 17:00:42,504 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822165942
2025-08-22 17:00:49,060 - workflows.po_workflow - INFO - Notifications sent for PO-20250822165942
2025-08-22 17:00:49,062 - workflows.po_workflow - INFO - PO processing completed for PO-20250822165942 in 66.96s
2025-08-22 17:00:49,062 - __main__ - INFO - PO PO-20250822165942 processed in 66.96s - Decision: PENDING_APPROVAL
2025-08-22 17:00:49,062 - __main__ - INFO - PaymentPlan | PO PO-20250822165942 | skipped (decision=PENDING_APPROVAL)
2025-08-22 17:00:50,075 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-22 17:00:50,075 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-22 17:00:50,076 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-22 17:00:52,047 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 17:00:52,049 - workflows.po_workflow - INFO - PO validation completed for PO-20250822170050
2025-08-22 17:00:52,050 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822170050
2025-08-22 17:01:11,748 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822170050
2025-08-22 17:01:11,750 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822170050
2025-08-22 17:01:31,144 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822170050
2025-08-22 17:01:44,153 - workflows.po_workflow - INFO - PO PO-20250822170050 auto-approved
2025-08-22 17:01:44,155 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822170050
2025-08-22 17:01:52,583 - workflows.po_workflow - INFO - Payment plan computed for PO PO-20250822170050
2025-08-22 17:01:52,585 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822170050
2025-08-22 17:01:59,411 - workflows.po_workflow - INFO - Notifications sent for PO-20250822170050
2025-08-22 17:01:59,413 - workflows.po_workflow - INFO - PO processing completed for PO-20250822170050 in 69.34s
2025-08-22 17:01:59,414 - __main__ - INFO - PO PO-20250822170050 processed in 69.34s - Decision: APPROVED
2025-08-22 17:01:59,414 - __main__ - INFO - PaymentPlan | PO PO-20250822170050 | skipped (decision=APPROVED)
2025-08-22 17:02:00,431 - __main__ - INFO - Processing PO 4 for supplier SUP999
2025-08-22 17:02:00,432 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP999
2025-08-22 17:02:00,433 - workflows.po_workflow - INFO - Starting PO validation for request: SUP999
2025-08-22 17:02:02,165 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 17:02:02,167 - workflows.po_workflow - INFO - PO validation completed for PO-20250822170200
2025-08-22 17:02:02,169 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822170200
2025-08-22 17:02:20,605 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822170200
2025-08-22 17:02:33,546 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822170200
2025-08-22 17:02:51,975 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822170200
2025-08-22 17:03:00,295 - workflows.po_workflow - INFO - Payment plan computed for PO PO-20250822170200
2025-08-22 17:03:00,297 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822170200
2025-08-22 17:03:07,147 - workflows.po_workflow - INFO - Notifications sent for PO-20250822170200
2025-08-22 17:03:07,149 - workflows.po_workflow - INFO - PO processing completed for PO-20250822170200 in 66.72s
2025-08-22 17:03:07,149 - __main__ - INFO - PO PO-20250822170200 processed in 66.72s - Decision: PENDING_APPROVAL
2025-08-22 17:03:07,149 - __main__ - INFO - PaymentPlan | PO PO-20250822170200 | skipped (decision=PENDING_APPROVAL)
2025-08-22 17:03:08,152 - database.db_operations - INFO - Database manager closed
2025-08-22 17:03:08,153 - __main__ - INFO - PO Automation System closed
2025-08-22 17:10:04,123 - __main__ - INFO - Initializing PO Automation System...
2025-08-22 17:10:04,123 - workflows.po_workflow - INFO - PO workflow initialized with MCP client
2025-08-22 17:10:04,123 - __main__ - INFO - PO Automation System initialized successfully
2025-08-22 17:10:04,706 - database.db_operations - INFO - Found 4 purchase orders
2025-08-22 17:10:04,849 - __main__ - INFO - Processing PO 1 for supplier SUP001
2025-08-22 17:10:04,850 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP001
2025-08-22 17:10:04,877 - workflows.po_workflow - INFO - PO workflow built successfully
2025-08-22 17:10:04,883 - workflows.po_workflow - INFO - Starting PO validation for request: SUP001
2025-08-22 17:10:06,774 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 17:10:06,781 - workflows.po_workflow - INFO - PO validation completed for PO-20250822171004
2025-08-22 17:10:06,782 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822171004
2025-08-22 17:10:25,489 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822171004
2025-08-22 17:10:25,490 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822171004
2025-08-22 17:10:37,501 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822171004
2025-08-22 17:10:56,201 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822171004
2025-08-22 17:11:05,402 - workflows.po_workflow - INFO - Payment plan computed for PO PO-20250822171004
2025-08-22 17:11:05,404 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822171004
2025-08-22 17:11:12,174 - workflows.po_workflow - INFO - Notifications sent for PO-20250822171004
2025-08-22 17:11:12,176 - workflows.po_workflow - INFO - PO processing completed for PO-20250822171004 in 67.33s
2025-08-22 17:11:12,176 - __main__ - INFO - PO PO-20250822171004 processed in 67.33s - Decision: PENDING_APPROVAL
2025-08-22 17:11:12,177 - __main__ - INFO - PaymentPlan | PO PO-20250822171004 | Band=LOW | Upfront%=100.00 | Upfront=$18,200.00 | Balance=$0.00
2025-08-22 17:11:13,184 - __main__ - INFO - Processing PO 2 for supplier SUP002
2025-08-22 17:11:13,185 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP002
2025-08-22 17:11:13,186 - workflows.po_workflow - INFO - Starting PO validation for request: SUP002
2025-08-22 17:11:14,978 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 17:11:14,980 - workflows.po_workflow - INFO - PO validation completed for PO-20250822171113
2025-08-22 17:11:14,981 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822171113
2025-08-22 17:11:33,910 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822171113
2025-08-22 17:11:33,911 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822171113
2025-08-22 17:11:47,057 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822171113
2025-08-22 17:12:06,001 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822171113
2025-08-22 17:12:14,513 - workflows.po_workflow - INFO - Payment plan computed for PO PO-20250822171113
2025-08-22 17:12:14,514 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822171113
2025-08-22 17:12:20,822 - workflows.po_workflow - INFO - Notifications sent for PO-20250822171113
2025-08-22 17:12:20,823 - workflows.po_workflow - INFO - PO processing completed for PO-20250822171113 in 67.64s
2025-08-22 17:12:20,824 - __main__ - INFO - PO PO-20250822171113 processed in 67.64s - Decision: PENDING_APPROVAL
2025-08-22 17:12:20,824 - __main__ - INFO - PaymentPlan | PO PO-20250822171113 | Band=LOW | Upfront%=100.00 | Upfront=$90,000.00 | Balance=$0.00
2025-08-22 17:12:21,838 - __main__ - INFO - Processing PO 3 for supplier SUP003
2025-08-22 17:12:21,839 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP003
2025-08-22 17:12:21,841 - workflows.po_workflow - INFO - Starting PO validation for request: SUP003
2025-08-22 17:12:23,513 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 17:12:23,515 - workflows.po_workflow - INFO - PO validation completed for PO-20250822171221
2025-08-22 17:12:23,517 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822171221
2025-08-22 17:12:41,868 - workflows.po_workflow - INFO - Supplier validation passed for PO-20250822171221
2025-08-22 17:12:41,870 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822171221
2025-08-22 17:12:59,935 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822171221
2025-08-22 17:13:12,491 - workflows.po_workflow - INFO - PO PO-20250822171221 auto-approved
2025-08-22 17:13:12,493 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822171221
2025-08-22 17:13:21,061 - workflows.po_workflow - INFO - Payment plan computed for PO PO-20250822171221
2025-08-22 17:13:21,063 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822171221
2025-08-22 17:13:27,603 - workflows.po_workflow - INFO - Notifications sent for PO-20250822171221
2025-08-22 17:13:27,605 - workflows.po_workflow - INFO - PO processing completed for PO-20250822171221 in 65.77s
2025-08-22 17:13:27,605 - __main__ - INFO - PO PO-20250822171221 processed in 65.77s - Decision: APPROVED
2025-08-22 17:13:27,605 - __main__ - INFO - PaymentPlan | PO PO-20250822171221 | Band=LOW | Upfront%=100.00 | Upfront=$640.00 | Balance=$0.00
2025-08-22 17:13:28,622 - __main__ - INFO - Processing PO 4 for supplier SUP999
2025-08-22 17:13:28,622 - workflows.po_workflow - INFO - Starting PO processing for supplier: SUP999
2025-08-22 17:13:28,623 - workflows.po_workflow - INFO - Starting PO validation for request: SUP999
2025-08-22 17:13:30,541 - httpx - INFO - HTTP Request: POST https://virat-kumar-openai.openai.azure.com/openai/deployments/gpt-4o/chat/completions?api-version=2023-05-15 "HTTP/1.1 200 OK"
2025-08-22 17:13:30,543 - workflows.po_workflow - INFO - PO validation completed for PO-20250822171328
2025-08-22 17:13:30,544 - workflows.po_workflow - INFO - Checking supplier for PO PO-20250822171328
2025-08-22 17:13:49,255 - workflows.po_workflow - INFO - Verifying budget for PO PO-20250822171328
2025-08-22 17:14:01,416 - workflows.po_workflow - INFO - Processing approval for PO PO-20250822171328
2025-08-22 17:14:19,947 - workflows.po_workflow - INFO - Calculating payment plan for PO PO-20250822171328
2025-08-22 17:14:28,271 - workflows.po_workflow - INFO - Payment plan computed for PO PO-20250822171328
2025-08-22 17:14:28,273 - workflows.po_workflow - INFO - Sending notifications for PO PO-20250822171328
2025-08-22 17:14:35,025 - workflows.po_workflow - INFO - Notifications sent for PO-20250822171328
2025-08-22 17:14:35,027 - workflows.po_workflow - INFO - PO processing completed for PO-20250822171328 in 66.40s
2025-08-22 17:14:35,027 - __main__ - INFO - PO PO-20250822171328 processed in 66.40s - Decision: PENDING_APPROVAL
2025-08-22 17:14:35,028 - __main__ - INFO - PaymentPlan | PO PO-20250822171328 | Band=VERY_HIGH | Upfront%=19.23 | Upfront=$5,730.77 | Balance=$24,069.23
2025-08-22 17:14:36,036 - database.db_operations - INFO - Database manager closed
2025-08-22 17:14:36,037 - __main__ - INFO - PO Automation System closed
